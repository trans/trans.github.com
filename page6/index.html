<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRANSCODE &mdash; Trans Technology and Programming Blog</title>
    <link href="http://fonts.googleapis.com/css?family=Droid+Sans:400,700" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/assets/main.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/images/trans-logo.png"/>
    <link href="/feed.xml" rel="alternate" type="application/rss+xml" title="TRANSCODE" />
    <meta name="title" content="TRANSCODE">
    <link rel="canonical" href="http://trans.github.com/page6/">
     
           
    <meta property="og:title" content="TRANSCODE"/>
    <meta property="og:url" content="http://trans.github.com/page6/"/>
    
    
    <meta property="og:site_name" content="TRANSCODE">
</head>
<body>
    
<section class="site-nav">
    <header>
        <nav id="navigation">
            <a class="brand" href="/">
                <img src="/images/trans-logo.png" alt="Inc" height="120px">
            </a>
            <a href="/" class="home">Blog</a>
            <a href="http://github.com/trans">Github</a>
            <a href="/About/">About</a>
        </nav>
        <nav class="tagline">
            <span>Check out all of my open source work</span>
            <a href="http://github.com/trans" class="btn btn-outline">Learn More</a>
        </nav>
    </header>
</section>

<div class="blog-cover" style="background-image:url(/images/blog-cover.jpg);">
    
    <section>
        <div class="container">
            <h1>TRANSCODE</h1>
            <h3>Trans Technology and Programming Blog</h3>
        
            
            <a href="https://twitter.com/transgigamic" title="Follow on Twitter" target="_blank"><i class="icon icon-twitter"></i></a>
            
            
            <a href="/feed.xml" title="RSS Feed">
                <i class="icon icon-rss"></i>
            </a>
        </div>
    </section>
</div>

<article class="container">

  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2009/10/23/a-proper-require/" rel="prefetch">A Proper Require</a></h2>
            <p><h1>A Proper Require</h1>

<p>Recently I <a href="http://groups.google.com/group/ruby-talk-google/browse_thread/thread/6a46c837ffc84761">posted</a>
a light diatribe against improper use of relative requires in Ruby programs.
I pointed-out a bit of code, I recently came across, that added a relative path to Ruby&#39;s
<code>$LOAD_PATH</code> from within a <code>bin/</code> executable.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">$LOAD_PATH.unshift(File.expand_path(File.dirname(__FILE__) + &quot;/../lib&quot;))
</code></pre></div>
<p>I suspect the author little realized that his program would not function if it were installed
according to traditional <a href="http://www.pathname.com/fhs/">FHS</a>-based standards. And I fear many
young Rubyists, having known nothing but the use of RubyGems and/or deployment (as opposed to release)
of Rails apps, do not understand the nature of the issue. In my post I stated some general rules.</p>

<h2>The Rules of Relative Loading</h2>

<ul>
<li>Don&#39;t mess with the <code>$LOAD_PATH</code>.</li>
<li>Use relative lookup only when you must, eg. using bundled HTML templates.</li>
<li>Any relative paths you do use must remain within the confines of their main directory (eg. lib/)</li>
<li>Don&#39;t use a relative lookup for any .rb or .so/.dll loading.</li>
<li>It should never be necessary to require &#39;rubygems&#39;.</li>
</ul>

<p><a href="http://blog.grayproductions.net/">James Edward Gray II</a> pointed out that
I had not been clear in stating the exceptions to these rules, so I add the
following.</p>

<h2>When the Rules Do <em>Not</em> Apply</h2>

<ul>
<li>They do not apply to Rails Apps since they are deployed, rather than packaged and installed.</li>
<li>Testing and building scripts are free from the rules since they are localized operations.</li>
</ul>

<p>Even when the rules do not apply, try to adhear to them as much as possible. For exmaple, minimize
the points of entry. At the very least it can benefit refactoring.</p>

<h2>Understanding the Rules</h2>

<p>Most of the responses to my post expressed understanding of the last rule, as there have been a few
write-ups on that subject before. But many could not understand the reasons behind the other points.
And it&#39;s no wonder. I did some research and discovered there to be a fair bit of misinformation
circulating promoting the use of relative loading as a &quot;proper&quot; solution, and very little information
explaining what is actually best practice.</p>

<p>It was the last reply to my post that made me realize I should take a moment to write this 
blog entry to more fully explain.</p>

<blockquote>
"As someone who wrote a dependency-resolving code loading gem, I am extremely
dubious that one can always avoid code loading using relative paths.
How would you ordinarily go about loading some .rb files in a subdirectory
beneath the directory in which the current file is located?"
</blockquote>

<p>Clearly we have a quite capable programmer here, having written &quot;a dependency-resolving code loading gem&quot;,
but the fact the he states that he wrote a &quot;gem&quot; rather then a &quot;library&quot; struck me as an indication
that some crucial old school knowledge is missing from his repertoire that inevitably lead him to
his second sentence.</p>

<p>The key, I believe, to alleviating this misunderstanding is Minero Aoki&#39;s <a href="http://i.loveruby.net/en/projects/setup/">Setup.rb</a>.
Before we had RubyGems, Aoki&#39;s <code>setup.rb</code> script was <em>the</em> way to install Ruby software, and his
work helped lay the foundation for the way in which Ruby projects are structured to this very day. The
first two sections of the Setup.rb <a href="http://i.loveruby.net/en/projects/setup/doc/">documentation</a>
should be required reading for all Rubyists.</p>

<p>Once we understand how Setup.rb works --where it puts a project&#39;s files upon installation, we can
then understand when we can and when we cannot get away with using relative requires. However, even
when we can do so, it does not mean we should. The idea of Setup.rb is to install your files
into the system locations where the <code>$LOAD_PATH</code> is already set to look. In other words,
you should not effect the <code>$LOAD_PATH</code> in your code, but make sure your code is where
the <code>$LOAD_PATH</code> expects it to be. The <code>$LOAD_PATH</code> is something managed externally,
by a system administrator, or a specially designed program for just such a purpose (like RubyGems).
By placing our code in the correct system locations, we will only ever need standard 
<code>require &#39;mylib/mysubdir/myfile&#39;</code> type load calls.</p>

<h2>How to Follow the Rules</h2>

<p>So how do we make sure our code is where it needs to be? In the old days we just used <code>setup.rb</code>.
By following it&#39;s conventions and installing our software with it, all was well. But today most Rubyists
use RubyGems. That works just as well, but there are two configuration issues that attend it&#39;s use.</p>

<ol>
<li>Our project&#39;s gemspec must have the proper <code>require_paths</code> setting. The default is the setup.rb standard <code>lib/</code>.</li>
<li>Our RUBYOPT environment setting must contain &quot;-rubygems&quot;.</li>
</ol>

<p>As I mentioned in the above bullet points, it is okay to add to the <code>$LOAD_PATH</code> when running tests --that&#39;s essential to avoid having to reinstall your project after every code change. But it&#39;s not acceptable to do so in your actual program.</p>

<p>I believe Minero Aoki has completed his work on Setup.rb, as there has not been any activity on his project
in some time. A while ago, I <a href="http://github.com/proutils/setup">forked Setup.rb</a> in order to make it a stand-alone package that can be installed via RubyGems. Since then I have continued it&#39;s development, working on few aspects of the system such as using optparse.rb for command-line parsing, removing the (unused) multi-package feature, adding doc/ installation and most recenty I started to rewrite the install code to be atomic (would love some assistance on that, btw!).</p>

<p>With the advent of RubyGems, <code>setup.rb</code> is not as widely needed as it once was (though it still gets used in some cases). Yet the ground work it laid is still with us, and should be understood if one wishes to be an effective Ruby programmer.</p>

<hr>

<p>title      : A Proper Require
author     : trans
categories : [ruby, require]
date       : 2009-10-23
layout     : post</p>
</p>
            <div class="meta">
                Written By <address></a> &mdash;
                <time pubdate datetime="2009-23-October" title="October 23, 2009">October 23, 2009</time>
            </div>
        </div>
        <hr>
    </section>
    
    
  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2009/07/04/The-Form-of-Project-Metadata/" rel="prefetch">The Form Of Project Metadata</a></h2>
            <p><h1>The Form of Project Metadata</h1>

<h2>Ruby Script</h2>

<p>Ruby-scripts as configuration is popular among gung-ho Ruby-enthusiests. And there is certainly
some merit to it&#39;s use, but along with the powerful advantages are serious disadvantages as well.</p>

<h3>Advantages</h3>

<ul>
<li>Computable settings is very flexiable.</li>
<li>Support full type support --Array, String, Integer, etc.</li>
</ul>

<h3>Disadvantages</h3>

<ul>
<li>Using Ruby code as configuration limits their use to Ruby programs.</li>
<li>Providing the full power of a scriptling language presents a higher security risk.</li>
<li>Automated modification of configuration scripts is difficult.</li>
</ul>

<p>Ruby scripts are not an uncommon configuration format, especailly in the area of
project tools --.gemspec files for instance are Ruby scripts. Their greatest advantage
is in their flexability --properties can be set computationally. However, the issues
of interoperability, security and editing automation make them a very limited
option.</p>

<h2>YAML</h2>

<p>In the world Ruby programming YAML is certainly the most common choice
of configuration storage. Since YAML is a human-readable serialization format,
this stand to reason.</p>

<h3>Advantages</h3>

<ul>
<li>Popular format amoung Rubyists; and becoming more popular with other languages.</li>
<li>Supports serialization types (string, array, hash, integer, time, etc).</li>
<li>Easy to en masse edit, as all settings can be in a single file.</li>
</ul>

<h3>Disadvantages</h3>

<ul>
<li>Requires dependency on a hefty parser library.</li>
<li>Difficult to automate selective modification. (Whole file needs to rewritten.)</li>
</ul>

<p>YAML has the advantage of en masse editing, which will certainly seems more comfortable
to the average Ruby coder. However, this advantage is limited primarily to first-time
editing of configuration data since, in our usecase, most properties will not
change once set.</p>

<p>YAML also has the advantage of supporting of basic types like String, Array, Hash,
and, in the Syck implementation, Time and Integer as well. These types provide some
extra information that can be used in determining the value of a property. However,
this also opens us up to greater potenial of data-type errors.</p>

<h2>INI</h2>

<h3>Advantages</h3>

<ul>
<li>INI files are very human readible and easy to edit.</li>
</ul>

<h3>Disadvantages</h3>

<ul>
<li>Requires parser library (but much smaller than YAML&#39;s).</li>
<li>Entries are generally limited to a single line entry.</li>
<li>No data types --all data are strings.</li>
</ul>

<p>INI files are even easier to read and write than YAML files. However they lack
serialization types. So all properties are strings and it&#39;s up to the application
to determine the type of data.  Also, on the whole, entries are limited
to a single line. This means list entries usually need to be separated by
a delimiter (<code>, : ;</code>), and long description entries need special consideration.</p>

<p>While INI files are conceptually simpler than YAML files, and in so being are
a more attractive solution (IMO), the difference between YAML and INI
does not seem great enough to warrant their use over the convention of
Rubyists to use YAML instead.</p>

<h2>Per-Property Files</h2>

<p>The use of one file per property has some significant advantages, but likewise
has a few issues that keep it from being a perfect solution.</p>

<h3>Advantages</h3>

<ul>
<li>No special parser library is required.</li>
<li>Individual file can be selectively loaded.</li>
<li>Very easy to automate selective update.</li>
<li>Usable by any language or tool.</li>
</ul>

<h3>Disadvantages</h3>

<ul>
<li>Cumbursome to edit properties en masse.</li>
<li>No data types --all data are strings (unless we use file extensions).</li>
<li>Wastes file system space (ie. block size).</li>
<li>Not as easily scrapable by search engines.</li>
<li>Highly unconventional appraoch.</li>
</ul>

<p>While some may take serious issue with the waste of file system space, this is increasingly
a negligable downside. Some modern file systems handle small files quite gacefully, and
the number of potential properties limits the waste in anycase.</p>

<p>While not being able to easily edit en masse might seem like a show-stopper, for this
usecase it is usually only needed for the initial editing. After that, editing metadata
tends to be very selective.</p>

<p>While per-propery files do not support data types per-se, if neccessary file extensions on
header comment lines (shebang lines) could be used to convey type.</p>

<p>Probably the biggest downside to the per-propery file approach though is the lack of convention
for doing so. It no doubt will strike most developers as a &quot;bad thing&quot;, at least at first.</p>

<h2>Analysis</h2>

<p>In considering the possible configuration formats, it becomes clear there are trade-offs.
No solution is perfect, but no solution is without it&#39;s merits either.</p>
</p>
            <div class="meta">
                Written By <address></a> &mdash;
                <time pubdate datetime="2009-04-July" title="July 04, 2009">July 04, 2009</time>
            </div>
        </div>
        <hr>
    </section>
    
    
  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2009/06/07/wxruby-for-the-lazy/" rel="prefetch">Wxruby For The Lazy</a></h2>
            <p><h1>WxRuby for the Lazy</h1>

<p><a href="http://wxruby.rubyforge.org/wiki/wiki.pl">WxRuby</a> is probably the best overall GUI library for Ruby currently available. It is cross-platform, provides native look-and-feel and is stable enough for production use. All other GUI libraries, despite their various merits, fall short in at least one of the areas. However, WxRuby does have one major downfall. It is pretty much a straight port of the C API. Writing WxRuby code is largely the same as writing actual WxWidgets C code. It&#39;s far from the &quot;Ruby Way&quot;.</p>

<p>So how did I mange to get fairly nice Ruby code despite a binding that is essentially a straight port of the underlying C API? I built it from the bottom-up using a lazy coding technique. And I mean &quot;bottom-up&quot; literally --the following code might actually be easier to read if you start from the bottom and work your way up to the top. The trick is to break down one&#39;s interface into individual widgets and create an instance method for each using the <code>||=</code> memoization trick. </p>

<p>You can see from the following code I was able to apply this &quot;trick&quot; to everything but toolbar buttons (aka &#39;tools&#39;). This is because the toolbar itself is needed to create them. So I simply defined attributes for each tool, but actually created the tool buttons in the toolbar&#39;s method. <a href="https://gist.github.com/trans/182301">Have a look</a>.</p>

<script src="https://gist.github.com/trans/182301.js"></script>

<p>The thing to notice, if you haven&#39;t caught it yet, is how calling <code>#search<em>toolbar</code> leads to calling <code>#search</em>sizer</code> which in turn leads to calling <code>#search<em>panel</code>, and so forth all the way to the top <code>#frame</em>panel</code>. This code is a striped down version of actual code I am using. I hope it helps others create wxRuby application more easily. As I said in my previous post, I found in mind-numbingly difficult to create WxRuby interfaces until I worked out this approach. WxRuby is still a difficult API to master, but this technique makes the effort more manageable, and therefore more likely to succeed. </p>

<p>For another example of building structures lazily, have a look at <a href="http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/122593">my solution</a> for <a href="http://rubyquiz.com/quiz10.html">Ruby Quiz 10 - Crosswords</a>.</p>

<!--
  title  : WxRuby for the Lazy
  author : trans
  tags   : [ruby, gui]
  date   : 2009-06-07
  layout : post
-->
</p>
            <div class="meta">
                Written By <address></a> &mdash;
                <time pubdate datetime="2009-07-June" title="June 07, 2009">June 07, 2009</time>
            </div>
        </div>
        <hr>
    </section>
    
    
  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2009/02/10/xml-meet-css/" rel="prefetch">Xml Meet Css</a></h2>
            <p><h1>XML+CSS, the Future of Web Design?</h1>

<p>In a <a href="http://tigerops.org/2009/01/mf-vs-xml.html">previous post</a>, I point out that microformats bring an additional layer of useful information to a document, which I dubbed <em>semantic structure</em>. In short, HTML tags provide useful <em>type</em> information about the data they contain. A good example of this has been the insistent push to use <code>div</code>s rather than <code>table</code>s for page layout. The reason is that tables describe a semantic structure, a table of data, and not layout. I for one have found this a frustrating haggle in the design of my pages. Time and time again I have been stymied by unwieldy <code>div</code>s. Tables are much easier to use, despite additional verbosity. But I have stuck to <code>div</code>s because it is &quot;the right thing to do&quot;. Thankfully my saving grace will soon be here. The 3rd revision the CSS standard supports a new <code>display</code> style. With it, one can specify that a div is to behave like a table, table row or table cell. Woohoo! Three cheers for tabley divs!!</p>

<p>This display style led me to think about semantic structure again. If we can designate that a <code>div</code> is a <code>table</code> structure via CSS, then why not any structure? And if <code>div</code>s, why not any tag? If we were able to do that, then semantic structure could be specified solely through CSS. And our HTML pages could go from rather simple, repetitive occurrences of <code>div</code> to ... can you guess?... pure XML.</p>

<p>Let&#39;s got through it step by step. Here some HTML [gist id=61726]:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml">    <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">&quot;ages&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;tr</span> <span class="na">class=</span><span class="s">&quot;person&quot;</span><span class="nt">&gt;&lt;td</span> <span class="na">class=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>John<span class="nt">&lt;/td&gt;&lt;td</span> <span class="na">class=</span><span class="s">&quot;age&quot;</span><span class="nt">&gt;</span>24<span class="nt">&lt;/td&gt;&lt;/tr&gt;</span>
      <span class="nt">&lt;tr</span> <span class="na">class=</span><span class="s">&quot;person&quot;</span><span class="nt">&gt;&lt;td</span> <span class="na">class=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Dean<span class="nt">&lt;/td&gt;&lt;td</span> <span class="na">class=</span><span class="s">&quot;age&quot;</span><span class="nt">&gt;</span>30<span class="nt">&lt;/td&gt;&lt;/tr&gt;</span>
    <span class="nt">&lt;/table&gt;</span>
</code></pre></div>
<p>Now with CSS 3 [gist id=61729]:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml">    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ages&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;person&quot;</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>John<span class="nt">&lt;/div&gt;&lt;div</span> <span class="na">class=</span><span class="s">&quot;age&quot;</span><span class="nt">&gt;</span>24<span class="nt">&lt;/div&gt;&lt;/div&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;person&quot;</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Dean<span class="nt">&lt;/div&gt;&lt;div</span> <span class="na">class=</span><span class="s">&quot;age&quot;</span><span class="nt">&gt;</span>30<span class="nt">&lt;/div&gt;&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

      .ages { display: table; }
    .person { display: table-row; }
      .name { display: table-cell; }
       .age { display: table-cell; }
</code></pre></div>
<p>Of course no one would recommend doing this to something that really is a table of data. But bare with me, because now we are coming full circle [gist id=61730]:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml">    <span class="nt">&lt;ages&gt;</span>
      <span class="nt">&lt;person&gt;&lt;name&gt;</span>John<span class="nt">&lt;/name&gt;&lt;age&gt;</span>24<span class="nt">&lt;/age&gt;&lt;/person&gt;</span>
      <span class="nt">&lt;person&gt;&lt;name&gt;</span>Dean<span class="nt">&lt;/name&gt;&lt;age&gt;</span>30<span class="nt">&lt;/age&gt;&lt;/person&gt;</span>
    <span class="nt">&lt;/ages&gt;</span>

      ages { display: table; }
    person { display: table-row; }
      name { display: table-cell; }
       age { display: table-cell; }
</code></pre></div>
<p>I think this is a rather remarkable outcome. And you might be surprised to learn that Firefox handles it just fine. What we have achieved is an ultra-clean separation between the data and it&#39;s semantic meaning, via XML, and it&#39;s semantic structure, via CSS. If this approach were embraced by the XHTML and CSS standards bodies, I would not be surprised to see it revolutionize web design.</p>

<hr>

<p>title      : XML. meet CSS
author     : trans
categories : [ruby]
date       : 2009-02-10
layout     : post</p>
</p>
            <div class="meta">
                Written By <address></a> &mdash;
                <time pubdate datetime="2009-10-February" title="February 10, 2009">February 10, 2009</time>
            </div>
        </div>
        <hr>
    </section>
    
    
  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2009/01/24/what%27s-uf-got-on-xml/" rel="prefetch">What's Uf Got On Xml</a></h2>
            <p><h1>What&#39;s &micro;F got on XML?</h1>

<p>Decisions, decisions. Therein lies the reason why convention over configuration is so bloody great, precisely because it requires fewer decisions. <a href="http://detroit.github.com/detroit">Detroit</a>, my awesome build tool, outputs log files. Yea, logs are good. But the decision I have to make is, &quot;in what format?&quot;</p>

<p>Now old-school would just put out some asterisk-studded text files with plenty of precise timestamps, maybe some nice long lines of dashes to divide things up. No doubt these files are easy to access and fairly readable. We like out text files. But hey wait. This is the age of magical markups. At the very least we can coax that log into a Wiki-tongue. For us Rubyists, we have rdoc, markdown and textile&#39;s just a few gemy fingertips away. These formats can be even easier to read thanks to structural consistency from log to log. Plus, fire-up a web server and we can get some really nice looking HTML too. That&#39;s the beauty of Wiki Wiki markup after all.</p>

<p>Now if beauty were all that matter, then there would be no point in looking further. But like America&#39;s continental shelves there is untapped wealth going to waste here. There is data in them there logs! The modern buzzword is <em>semantic</em>. Taking logs to the next level requires us to ensure their semantic value. On that account, XML was created, and long predicted the format of the future. Certainly XML has made great strides, but it is still far from meeting its promise. There is simply too much complexity involved in both marking up the content and in generating nice output.</p>

<p>Then comes along the <em>microformat</em>. The microformat combines the semantic capabilities of XML with the layout capabilities of HTML. Microformats are relatively new and still finding their footing. Indeed, I think a <em>Universal Uniform Microformat Specification</em> is ultimately the necessary outcome. In that vain I make a first rough estimate of what such unifying system might look like, and why, contrary to many arguments otherwise, microformats do in fact bring more to the table than XML.</p>

<p>Where XML provides semantic information within a doubly linked hierarchy (via attributes and body), microformats provide the same plus a set of well defined data structures. Microformats provide semantics through a small set of tag attributes, <em>role</em>, <em>rel</em>, <em>rev</em> and primarily the <em>class</em> attribute. The <em>class</em> attribute alone is enough to make microformats fully equatable to XML. We can easily map the same data set in either format:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml">    <span class="nt">&lt;people&gt;</span>
      <span class="nt">&lt;person&gt;</span>
        <span class="nt">&lt;name&gt;</span>John Jay<span class="nt">&lt;/name&gt;</span>
      <span class="nt">&lt;/person&gt;</span>
    <span class="nt">&lt;/people&gt;</span>
</code></pre></div>
<p>As opposed to...</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml">    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;people&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;person&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>John Jay<span class="nt">&lt;/span&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
</code></pre></div>
<p>Although the microformat is more verbose, the two contian the same original semantic value. But the extra verbosity isn&#39;t just a waste of UTF bytecodes, it says something. Specifically it gives us a <em>semantic structure</em>. It just so happens that HTML evolved to offer these structures precisely because that is what data presenters require to do their jobs well. And for the same reason, why you are always being beat with the <code>div</code>-stick when you try to take the load road of laying out your pages with tables.</p>

<p>So what semantic structures do micorformats via HTML make available to us? The quick rundown: we have layouts using <em>div</em> and <em>span</em>, lists using <em>ol</em>, <em>ul</em> and <em>li</em>; definition lists using <em>dl</em>, <em>dd</em> and <em>dt</em>; and tables using <em>table</em>, <em>tr</em>, <em>th</em> and <em>td</em>. Those are the obvious structures. There are still other smaller structure&#39;s like <em>a</em> for links, and the hefty set of <em>form</em> elements. All these elements provide us a way to say what type of thing our data is or partakes in, not just what the data is.</p>

<p>Clearly, the creators of XML saw the need for something like this and tried to achieve it through XML Namespaces. But namespaces are less effective because they are completely arbitrary, whereas HTML gives us a limited but universal structural language. Seems to me there is a principle to be found here that can be a guide for both the future of HTML and Microformats.</p>

<hr>

<p>title      : What&#39;s &micro;F got on XML?
author     : trans
categories : [website]
date       : 2009-01-24
layout     : post</p>
</p>
            <div class="meta">
                Written By <address></a> &mdash;
                <time pubdate datetime="2009-24-January" title="January 24, 2009">January 24, 2009</time>
            </div>
        </div>
        <hr>
    </section>
    
    
  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2008/11/04/the-yadsl-rule/" rel="prefetch">The Yadsl Rule</a></h2>
            <p><h1>The YADSL Rule</h1>

<p>Looks like the Ruby world is a fire with new DSLs for BDD/TDD. There&#39;s 
<a href="http://rspec.info/">RSpec</a>,
<a href="http://blog.zenspider.com/minitest/">minitest</a>,
<a href="http://test-unit.rubyforge.org/test-unit/">Test::Unit 2.x</a>,
<a href="http://test-spec.rubyforge.org/test-spec/">test-spec</a>,
<a href="http://www.oreillynet.com/ruby/blog/2008/02/assert2.html">Assert 2.0</a>,
<a href="http://expectations.rubyforge.org/">Expectations</a>,
<a href="http://github.com/aslakhellesoy/cucumber/tree/master">Cucumber</a>,
<a href="http://github.com/carlosbrando/remarkable/tree/master">Remarkable</a>,
<a href="http://www.thoughtbot.com/projects/shoulda/">Shoulda</a>
... woulda, coulda ... My word! So many choices. It&#39;s fitting that
it&#39;s Thanksgiving, what we have here is a <i>cornucopia of framework</i>!!!</p>

<p>Uh... Okay, you&#39;ll have to forgive me. I get carried away.</p>

<p>I suppose it all started with that RSpec. Those guys built an incredibly 
elaborate nomenclature to help us spell out our code&#39;s behaviors in gruesome
detail. But as wonderfully grandiose as it may be, there&#39;s just one tiny little
itty-bitty problem... <i>I can&#39;t remember it</i>. Oh, sure, I could sit down and
jam it into my already overloaded brain somewhere, but you know what. I ain&#39;t
gonna. I already have enough new stuff to learn and I&#39;m not going to bother to
learn another DSL when those I already know work just as well.</p>

<p>So therein lies the serious downside to any new DSL. They require more brain
cells. We&#39;re talking the old &quot;learning yet another language&quot; dilemma here. I was
thinking about this today, and it strikes me as one of those cool rules we oft
hear about. So I decided to &#39;writ&#39; one for the occasion.</p>

<blockquote>
  "Don't create a DSL if a native solution would be just as elegant."
</blockquote>

<p>In fact, a good DSL will likely need to be substantially more elegant in order
to fully justify its existence.</p>

<p>I&#39;m calling this the <i>YADSL Rule</i>, for &quot;Yet Another Domain Specific Language&quot;.</p>

<p>Now, a quick look around the world of modern programming 
(see <a href="http://dzone.com">DZone</a>),
just as quickly makes clear that the YADSL rule is in no short supply of
violations. Indeed, I dare say, that most of programming today is not innovative,
but masquerading around as such via YADSL.</p>

<p>Now I don&#39;t want to seem too harsh. There is of course a certain level of
refinement taking place in some areas. And that naturally has to play itself
out. But it&#39;s getting a little crazy. Besides test frameworks, web frameworks 
and Javscript development frameworks seem to have hit a New Cambrian Explosion.
I don&#39;t see how we&#39;re supposed to keep up with it.
I can only hope that my little rule might help to cool all
this exuberance down a bit; so we can catch our breaths and take some time
to consider the torrential downpour of verbiage that has befallen us.</p>

<p>Of course, the real problem may be that too many people want to make YANFT
(Yet Another Name For Themselves).</p>

<p>I swear to you. I&#39;m not one of them. But I will be introducing my own Ruby
test framework soon.</p>

<p>No. I&#39;m not kidding.</p>

<p>Don&#39;t worry, there&#39;s no new DSL to learn. And that&#39;s what makes my framework
so very special. I&#39;ll keep you posted.</p>

<!--
title      : The YADSL Rule
author     : trans
date       : 2008-11-04
categories : [yadsl, dsl, ruby]
layout     : post
-->
</p>
            <div class="meta">
                Written By <address></a> &mdash;
                <time pubdate datetime="2008-04-November" title="November 04, 2008">November 04, 2008</time>
            </div>
        </div>
        <hr>
    </section>
    
    
  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2008/10/06/this-old-hash/" rel="prefetch">This Old Hash</a></h2>
            <p><h1>This Old Hash</h1>

<p>The Hash may well be the most used class in Ruby. Sure, our programs
have arrays and strings galore, but they generally come and go without
much ado. Hashes on the other hand get <em>used</em>; and by that I mean to
say, we spend a lot of time fussing with them. I think there are two
significant reasons for this and I will focus on the first, and
the more important of the two, here.</p>

<p>Now, I suspect you would agree, if I were to present you with a class
which was clearly overkill for vast majority of its intended uses, and
its use required repeated mitigation of its unused features, I have no
doubt, you&#39;d unequivocally advise me to select a &quot;<i>better tool for the job</i>&quot;.
And yet, that&#39;s the situation all Ruby programmers face, day in and
day out, with Ruby&#39;s Hash.</p>

<p>Ruby&#39;s Hash is exceptionally powerful because it supports any type of
object as a hash key. That&#39;s really really cool... for all of about
five minutes. The truth is, the vast majority of cases only require
one type of key --for Ruby that will either be a Symbol or a String,
and because of this, a great deal of time and code is wasted ensuring
all keys are that single type. Because of this, methods like 
<code>#to_sym</code> often riddle our scripts.</p>

<p>The issue is undeniably attested to by real world &quot;solutions&quot;
others have created to address it, such as Ruby Facets&#39;
<a href="http://facets.rubyforge.org/doc/api/core/classes/Hash.html#M000124">Hash#rekey</a>.
and Ruby on Rails&#39;
<a href="http://api.rubyonrails.org/classes/HashWithIndifferentAccess.html">HashWithIndifferentAccess</a>.
But let&#39;s face it, these are both underwhelming attempts at mitigating
the fundamental problem.</p>

<p>A real solution would have the current Hash class renamed, and a new
limited-key structure put in its place. The old class would still be
available, of course, for those special cases when a key of any object
type is required, but the new, more utilitarian Hash class would be
the literally-constructed default. The end effect of this change would
be simple:</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">    <span class="n">h</span><span class="o">[</span><span class="s1">&#39;a&#39;</span><span class="o">]</span> <span class="o">==</span> <span class="n">h</span><span class="o">[</span><span class="ss">:a</span><span class="o">]</span>
    <span class="n">h</span><span class="o">[</span><span class="s1">&#39;1&#39;</span><span class="o">]</span> <span class="o">==</span> <span class="n">h</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span>
</code></pre></div>
<p>This means reducing all hash keys to a single <em>symbolic</em> index type.
It does not matter what the actual reference is, a String, Symbol,
Integer, etc. just so long as it has a predictable symbolic
representation.</p>

<p>It may feel a bit strange to consider a suggestion that actually calls
for the reduction of features. More often change requests call for just
the opposite and YAGNI has to be peddled out on them. But, I think, we 
often underestimate the power of simplicity. Consider ideas such as 
convention-over-configuration and duck-typing --simplifications that
are not necessarily intuitive at first. But in the end, they make our
life as programmers a good bit more productive.</p>

<blockquote>
"Make everything as simple as possible, but not simpler."
<cite>--Albert Einstein</cite>
</blockquote>

<hr>

<p>title      : This Old Hash
author     : trans
date       : 2008-10-06
categories : [ruby, hash]
layout     : post</p>
</p>
            <div class="meta">
                Written By <address></a> &mdash;
                <time pubdate datetime="2008-06-October" title="October 06, 2008">October 06, 2008</time>
            </div>
        </div>
        <hr>
    </section>
    
    
  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2008/09/28/if-and-oopy-if/" rel="prefetch">If And Oopy If</a></h2>
            <p><h1>An Ally OOP for If-Conditions</h1>

<p>Ruby takes a unique approach to conditional evaluation: <i>All
objects are equivalent to <code>true</code> except <code>nil</code>
and <code>false</code></i>. No doubt this is a more object-oriented
approach than, say, C&#39;s use of <code>0</code> as false, but it&#39;s far
from the ideal of OOP all the way down, as any
<a href="http://pozorvlak.livejournal.com/94558.html">Smalltalker</a>
can attest.</p>

<p>Consider the following case. For a while now. I have wanted in my arsonal
of Ruby classes a NullClass defined basically as:</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">    <span class="k">class</span> <span class="nc">NullClass</span> <span class="o">&lt;</span> <span class="no">NilClass</span>
      <span class="k">def</span> <span class="nf">method_missing</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
        <span class="nb">self</span>
      <span class="k">end</span>
    <span class="k">end</span>

    <span class="no">NULL</span> <span class="o">=</span> <span class="no">NullClass</span><span class="o">.</span><span class="n">new</span>

    <span class="k">def</span> <span class="nf">null</span>
      <span class="no">NULL</span>
    <span class="k">end</span>
</code></pre></div>
<p>This object would greatly benefit fluent interfaces. Instead of returning
<code>nil</code>, such intefaces could return <code>null</code>, and no 
error would be thrown when invoking any method against it.</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">    <span class="n">obj</span> <span class="o">=</span> <span class="n">null</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">it</span><span class="o">.</span><span class="n">does</span><span class="o">.</span><span class="n">not</span><span class="o">.</span><span class="n">matter</span>  <span class="c1">#=&gt; null</span>
</code></pre></div>
<p>Unfortunately <code>null</code> is not very viable in Ruby
because <code>null</code> still evaluates as <code>true</code>
when used as the expression of a condition. The fact remains,
Ruby is hardcoded to see only the singleton instances of 
<code>NilClass</code> and <code>FalseClass</code> as false.</p>

<p>I&#39;ve requested that <code>NullClass</code> be added to core Ruby in
the past (as of yet to no avail) and though I still would like to
see it included, it may be better still to take an altogether 
object-oriented approach to conditions --in the spirit of Smalltalk.
This would allow us to freely create &quot;false&quot; objects, like the
<code>NullClass</code>, ourselves.</p>

<p>The adoption of such a capability does not require the odd syntax 
used by Smalltalk (<code>ifTrue</code> / <code>ifFalse</code>).
Rather, it can take an approach more akin to Ruby&#39;s own <code>case</code>
statements. As with <code>case</code>&#39;s use of <code>#===</code>,
a particular method would be used to evaluate the &quot;truthiness&quot; of
a value. This would apply for all types of conditions: 
<code>while</code>, <code>until</code>, etc. </p>

<p>To clarify, let&#39;s say this special method is simply called #if, then...</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">    <span class="k">class</span> <span class="nc">IfExample</span>
      <span class="kp">attr</span> <span class="ss">:if</span>
      <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="vi">@if</span><span class="p">)</span>
        <span class="vi">@if</span> <span class="o">=</span> <span class="k">if</span>
      <span class="k">end</span>
    <span class="k">end</span>

    <span class="n">x</span> <span class="o">=</span> <span class="no">IfExample</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="kp">false</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">x</span>
      <span class="s2">&quot;Yes&quot;</span>
    <span class="k">else</span>
      <span class="s2">&quot;No&quot;</span>
    <span class="k">end</span>
</code></pre></div>
<p>The result of this condition would be <code>&quot;No&quot;</code>.</p>

<p>While it may not be an earth shattering adjustment, the additional
flexibility opens up some interesting doors. Not only would classes
like the previously mentioned <code>NullClass</code> become possible,
but conditions themselves become <i>dynamically controllable</i>.</p>

<p>For example, it would allow method probes to fully map method
signatures (the Halting Problem not withstanding). This is not 
currently possible in Ruby because a probe cannot pretend to evaluate
to false in order to walk through the false side of a condition.</p>

<p>The idea would require some getting used to --after all a simple 
if-statement would no longer do what we Rubyists presently take 
for granted. But then, that&#39;s the nature of progress, is it not?</p>

<hr>

<p>title      : If and OOPy If
author     : trans
date       : 2008-09-28
categories : [ruby, nullclass]
layout     : post</p>
</p>
            <div class="meta">
                Written By <address></a> &mdash;
                <time pubdate datetime="2008-28-September" title="September 28, 2008">September 28, 2008</time>
            </div>
        </div>
        <hr>
    </section>
    
    
  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2008/09/12/taskable/" rel="prefetch">Taskable</a></h2>
            <p><h1>Taskable</h1>

<p>On more than a few occasions I have taken a stab at writing a general
purpose task system, akin to Rake&#39;s, but one that works within the
framework of Ruby class inheritance. I recall my first attempt was
quite an unwieldy beast, and my subsequent attempts were fairly
unwieldy too, but over time they became more concise. Below is the
most concise variation yet, and I was wondering what other thought
of it -- do you see any flaws in the design; does it satisfy all the
criteria of such a system; would you find it useful; etc.</p>

<p>One issue to note about the code, is the use of the <code>*_trigger</code> methods.
I&#39;m not sure that&#39;s the best approach. My original approach was
to provide a #run method (you can see it commented out), but this
requires dividing Taskable into two parts, a module for extending and
a module for including, and I try to avoid that design when I can.</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">    <span class="k">module</span> <span class="nn">Taskable</span>

      <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">append_features</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
        <span class="n">base</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span>
      <span class="k">end</span>

      <span class="c1"># Without an argument, returns list of tasks defined for this class.</span>
      <span class="c1">#</span>
      <span class="c1"># If a task&#39;s target name is given, will return the first</span>
      <span class="c1"># task matching the name found in the class&#39; inheritance chain.</span>
      <span class="c1"># This is important to ensure tasks are inherited in the same manner</span>
      <span class="c1"># that methods are.</span>
      <span class="k">def</span> <span class="nf">tasks</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="kp">nil</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">target</span>
          <span class="n">target</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">to_sym</span>
          <span class="n">anc</span> <span class="o">=</span> <span class="nb">ancestors</span><span class="o">.</span><span class="n">select</span><span class="p">{</span><span class="o">|</span><span class="n">a</span><span class="o">|</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="no">Taskable</span><span class="p">}</span> <span class="c1">#DSL</span>
          <span class="n">t</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">;</span> <span class="n">anc</span><span class="o">.</span><span class="n">find</span><span class="p">{</span><span class="o">|</span><span class="n">a</span><span class="o">|</span> <span class="n">t</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">tasks</span><span class="o">[</span><span class="n">target</span><span class="o">]</span><span class="p">}</span>
          <span class="k">return</span> <span class="n">t</span>
        <span class="k">else</span>
          <span class="vi">@tasks</span> <span class="o">||=</span> <span class="p">{}</span>
        <span class="k">end</span>
      <span class="k">end</span>

      <span class="c1"># Set a description to be used by then next defined task in this class.</span>
      <span class="k">def</span> <span class="nf">desc</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
        <span class="vi">@desc</span> <span class="o">=</span> <span class="n">description</span>
      <span class="k">end</span>

      <span class="c1"># Define a task.</span>
      <span class="k">def</span> <span class="nf">task</span><span class="p">(</span><span class="n">target_and_requisite</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">function</span><span class="p">)</span>
        <span class="n">target</span><span class="p">,</span> <span class="n">requisite</span><span class="p">,</span> <span class="n">function</span> <span class="o">=</span> <span class="o">*</span><span class="no">Task</span><span class="o">.</span><span class="n">parse_arguments</span><span class="p">(</span><span class="n">target_and_requisite</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">function</span><span class="p">)</span>
        <span class="n">task</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">[</span><span class="n">target</span><span class="o">.</span><span class="n">to_sym</span><span class="o">]</span> <span class="o">||=</span> <span class="p">(</span>
          <span class="n">tdesc</span> <span class="o">=</span> <span class="vi">@desc</span>
          <span class="vi">@desc</span> <span class="o">=</span> <span class="kp">nil</span>
          <span class="no">Task</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="nb">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">tdesc</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">task</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">requisite</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">function</span><span class="p">)</span>
        <span class="n">define_method</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">target</span><span class="si">}</span><span class="s2">_trigger&quot;</span><span class="p">){</span> <span class="n">task</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span> <span class="p">}</span>  <span class="c1"># or use #run?</span>
        <span class="n">define_method</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">target</span><span class="si">}</span><span class="s2">:task&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">function</span><span class="p">)</span> <span class="c1"># TODO: in 1.9 use instance_exec instead.</span>
      <span class="k">end</span>

      <span class="c1"># Run a task.</span>
      <span class="c1"># Hmmm... to add this would require another module (to include).</span>
      <span class="c1"># But I&#39;m not sure. Maybe trigger method is the better way?</span>
      <span class="c1">#</span>
      <span class="c1">#def run(target)</span>
      <span class="c1">#  #t = self.class.tasks(target)</span>
      <span class="c1">#  #t.run(self)</span>
      <span class="c1">#  send(&quot;#{target}_trigger&quot;)</span>
      <span class="c1">#end</span>

      <span class="c1"># = Task Class</span>
      <span class="c1">#</span>
      <span class="k">class</span> <span class="nc">Task</span>
        <span class="kp">attr</span> <span class="ss">:base</span>
        <span class="kp">attr</span> <span class="ss">:target</span>
        <span class="kp">attr</span> <span class="ss">:requisite</span>
        <span class="kp">attr</span> <span class="ss">:function</span>
        <span class="kp">attr</span> <span class="ss">:description</span>

        <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kp">nil</span><span class="p">,</span> <span class="n">requisite</span><span class="o">=</span><span class="kp">nil</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">function</span><span class="p">)</span>
          <span class="vi">@base</span>        <span class="o">=</span> <span class="n">base</span>
          <span class="vi">@target</span>      <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">to_sym</span>
          <span class="vi">@description</span> <span class="o">=</span> <span class="n">description</span>
          <span class="vi">@requisite</span>   <span class="o">=</span> <span class="n">requisite</span> <span class="o">||</span> <span class="o">[]</span>
          <span class="vi">@function</span>    <span class="o">=</span> <span class="n">function</span>
        <span class="k">end</span>

        <span class="c1">#</span>
        <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">requisite</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">function</span><span class="p">)</span>
          <span class="vi">@requisite</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">requisite</span><span class="p">)</span><span class="o">.</span><span class="n">uniq!</span>
          <span class="vi">@function</span> <span class="o">=</span> <span class="n">function</span> <span class="k">if</span> <span class="n">function</span>
        <span class="k">end</span>

        <span class="c1">#</span>
        <span class="k">def</span> <span class="nf">prerequisite</span>
          <span class="n">base</span><span class="o">.</span><span class="n">ancestors</span><span class="o">.</span><span class="n">select</span><span class="p">{</span> <span class="o">|</span><span class="n">a</span><span class="o">|</span> <span class="n">a</span><span class="o">.</span><span class="n">is_a?</span><span class="p">(</span><span class="no">Taskable</span><span class="p">)</span> <span class="p">}</span><span class="o">.</span><span class="n">collect</span><span class="p">{</span> <span class="o">|</span><span class="n">a</span><span class="o">|</span>
            <span class="n">a</span><span class="o">.</span><span class="n">tasks</span><span class="o">[</span><span class="n">target</span><span class="o">].</span><span class="n">requisite</span>
          <span class="p">}</span><span class="o">.</span><span class="n">flatten</span><span class="o">.</span><span class="n">uniq</span>
        <span class="k">end</span>

        <span class="c1"># invoke target</span>
        <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">object</span><span class="p">)</span>
          <span class="n">rd</span> <span class="o">=</span> <span class="n">rule_dag</span>
          <span class="n">rd</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
            <span class="n">object</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">t</span><span class="si">}</span><span class="s2">:task&quot;</span><span class="p">)</span>
          <span class="k">end</span>
        <span class="k">end</span>

        <span class="c1">#</span>
        <span class="c1">#def call(object)</span>
        <span class="c1">#  object.instance_eval(&amp;function)</span>
        <span class="c1">#end</span>

        <span class="c1"># Collect task dependencies for running.</span>
        <span class="k">def</span> <span class="nf">rule_dag</span><span class="p">(</span><span class="n">cache</span><span class="o">=[]</span><span class="p">)</span>
          <span class="n">prerequisite</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">r</span><span class="o">|</span>
            <span class="k">next</span> <span class="k">if</span> <span class="n">cache</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">tasks</span><span class="o">[</span><span class="n">r</span><span class="o">]</span>
            <span class="n">t</span><span class="o">.</span><span class="n">rule_dag</span><span class="p">(</span><span class="n">cache</span><span class="p">)</span>
            <span class="c1">#cache &lt;&lt; dep</span>
          <span class="k">end</span>
          <span class="n">cache</span> <span class="o">&lt;&lt;</span> <span class="n">target</span><span class="o">.</span><span class="n">to_s</span>
          <span class="n">cache</span>
        <span class="k">end</span>

        <span class="c1">#</span>
        <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">parse_arguments</span><span class="p">(</span><span class="n">name_and_reqs</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">action</span><span class="p">)</span>
          <span class="k">if</span> <span class="no">Hash</span><span class="o">===</span><span class="n">name_and_reqs</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">name_and_reqs</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">to_s</span>
            <span class="n">reqs</span> <span class="o">=</span> <span class="o">[</span><span class="n">name_and_reqs</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">first</span><span class="o">].</span><span class="n">flatten</span>
          <span class="k">else</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">name_and_reqs</span><span class="o">.</span><span class="n">to_s</span>
            <span class="n">reqs</span> <span class="o">=</span> <span class="o">[]</span>
          <span class="k">end</span>
          <span class="k">return</span> <span class="n">target</span><span class="p">,</span> <span class="n">reqs</span><span class="p">,</span> <span class="n">action</span>
        <span class="k">end</span>
      <span class="k">end</span>
    <span class="k">end</span>
</code></pre></div>
<p>Here&#39;s a very simple <a href="http://quarry.rubyforge.org">QEDoc</a> demo/spec:</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">    <span class="k">class</span> <span class="nc">Example</span>
      <span class="kp">include</span> <span class="no">Taskable</span>

      <span class="n">task</span> <span class="ss">:task_with_no_requisites</span> <span class="k">do</span>
        <span class="n">cache</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;task_with_no_requisites&quot;</span>
      <span class="k">end</span>

      <span class="n">task</span> <span class="ss">:task_with_one_requisite</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="ss">:task_with_no_requisites</span><span class="o">]</span> <span class="k">do</span>
        <span class="n">cache</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;task_with_one_requisite&quot;</span>
      <span class="k">end</span>

      <span class="k">def</span> <span class="nf">cache</span>
        <span class="vi">@cache</span> <span class="o">||=</span> <span class="o">[]</span>
      <span class="k">end</span>
    <span class="k">end</span>

    <span class="n">example</span> <span class="o">=</span> <span class="no">Example</span><span class="o">.</span><span class="n">new</span>
    <span class="c1">#example.run :task_with_no_requisites</span>
    <span class="n">example</span><span class="o">.</span><span class="n">task_with_no_requisites_trigger</span>
    <span class="n">example</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">assert</span> <span class="o">==</span> <span class="o">[</span><span class="s2">&quot;task_with_no_requisites&quot;</span><span class="o">]</span>

    <span class="n">example</span> <span class="o">=</span> <span class="no">Example</span><span class="o">.</span><span class="n">new</span>
    <span class="c1">#example.run :task_with_one_requisite</span>
    <span class="n">example</span><span class="o">.</span><span class="n">task_with_one_requisite_trigger</span>
    <span class="n">example</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">assert</span> <span class="o">==</span> <span class="o">[</span><span class="s2">&quot;task_with_no_requisites&quot;</span><span class="p">,</span> <span class="s2">&quot;task_with_one_requisite&quot;</span><span class="o">]</span>
</code></pre></div>
<p>So, what do you think?</p>

<hr>

<p>title      : Taskable
date       : 2008-09-12
categories : [ruby]
layout     : post</p>
</p>
            <div class="meta">
                Written By <address></a> &mdash;
                <time pubdate datetime="2008-12-September" title="September 12, 2008">September 12, 2008</time>
            </div>
        </div>
        <hr>
    </section>
    
    
  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2007/05/02/the-library-poll/" rel="prefetch">The Library Poll</a></h2>
            <p><h1>The Library Poll</h1>

<p>I&#39;ve been thinking far too long about how best to organize and distribute programming libraries. Having a hard time coming to any firm conclusions, I&#39;ve decided to try an inductive approach --via a poll. If you have a moment, I&#39;d really appreciate your thoughtful answers to the following questions. Thanks!</p>

<p><strong>Sorry, the polls are closed</strong>. But here are the results:</p>

<p>1) Which library name would you prefer: (<code>126</code> votes)</p>

<ul>
<li><code>37%</code> livelibs-file</li>
<li><code>63%</code> filestorm</li>
</ul>

<p>2) Which library would you be more likely to try: (<code>204</code> votes)</p>

<ul>
<li><code>62%</code> cliutils</li>
<li><code>10%</code> cli/best</li>
<li><code>03%</code> cliBest</li>
<li><code>24%</code> climax</li>
</ul>

<p>3) Should programming libraries be named: (<code>211</code> votes)</p>

<ul>
<li><code>45%</code> Creatively</li>
<li><code>55%</code> Categorically</li>
</ul>

<p>4) Programming libraries should be packaged: (<code>200</code> votes)</p>

<ul>
<li><code>35%</code> Per specific tool</li>
<li><code>47%</code> Per related set of tools</li>
<li><code>18%</code> Comprehensively (all-in-one)</li>
</ul>
</p>
            <div class="meta">
                Written By <address></a> &mdash;
                <time pubdate datetime="2007-02-May" title="May 02, 2007">May 02, 2007</time>
            </div>
        </div>
        <hr>
    </section>
    
    
    <section class="pagination" style="text-align:center">
      
        
        <a href="/page5" class="btn btn-outline"> Newer</a>
        
      
      
        <a href="/page7" class="btn btn-outline">Older </a>
      
    </section>
</article>


<footer class="site-footer">
    <div class="container">
        &copy; 2014 
        
        <nav>
            <a href="http://transcode.github.com">TRANS</a> &middot;
            <a href="/">Blog</a> &middot;
            <a href="http://github.com/trans">Product</a> &middot; 
            <a href="/About/">About</a>
        </nav>
        
        <nav class="social">
            
            <a href="https://twitter.com/transgigamic" title="Follow on Twitter" target="_blank"><i class="icon icon-twitter black"></i></a>
            
                
            <a href="/feed.xml" title="RSS Feed">
                <i class="icon icon-rss black"></i>
            </a>
        </nav>
        <p>Incorporated theme by <a href="https://sendtoinc.com">Inc</a></p>
    </div>
</footer>

<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="/assets/main.js"></script>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
<script>
    (function(d, t) {
        var g = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        g.src = '//hnbutton.appspot.com/static/hn.min.js';
        s.parentNode.insertBefore(g, s);
    }(document, 'script'));
</script>


</body>
</html>
