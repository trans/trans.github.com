<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRANSCODE &mdash; Trans Technology and Programming Blog</title>
    <link href="http://fonts.googleapis.com/css?family=Droid+Sans:400,700" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/assets/main.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/images/logo.png"/>
    <link href="/feed.xml" rel="alternate" type="application/rss+xml" title="TRANSCODE" />
    <meta name="title" content="TRANSCODE">
    <link rel="canonical" href="http://trans.github.com/page7/">
     
           
    <meta property="og:title" content="TRANSCODE"/>
    <meta property="og:url" content="http://trans.github.com/page7/"/>
    
    
    <meta property="og:site_name" content="TRANSCODE">
</head>
<body>
    
<section class="site-nav">
    <header>
        <nav id="navigation">
            <a class="brand" href="/">
                <img src="/images/logo.png" alt="Inc">
            </a>
            <a href="/" class="home">Blog</a>
            <a href="http://incorporated.sendtoinc.com/">Product</a>
            <a href="https://tabcomputing.com/about/">About</a>
        </nav>
        <nav class="tagline">
            <span>Get a modern blog for your company</span>
            <a href="http://incorporated.sendtoinc.com/" class="btn btn-outline">Learn More</a>
        </nav>
    </header>
</section>

<div class="blog-cover" style="background-image:url(/images/blog-cover.jpg);">
    
    <section>
        <div class="container">
            <h1>TRANSCODE</h1>
            <h3>Trans Technology and Programming Blog</h3>
        
            
            
            <a href="/feed.xml" title="RSS Feed">
                <i class="icon icon-rss"></i>
            </a>
        </div>
    </section>
</div>

<article class="container">

  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2009/02/10/xml-meet-css/" rel="prefetch">Ruby AOP Made Simple</a></h2>
            <p><h1>XML+CSS, the Future of Web Design?</h1>

<p>In a <a href="http://tigerops.org/2009/01/mf-vs-xml.html">previous post</a>, I point out that microformats bring an additional layer of useful information to a document, which I dubbed <em>semantic structure</em>. In short, HTML tags provide useful <em>type</em> information about the data they contain. A good example of this has been the insistent push to use <code>div</code>s rather than <code>table</code>s for page layout. The reason is that tables describe a semantic structure, a table of data, and not layout. I for one have found this a frustrating haggle in the design of my pages. Time and time again I have been stymied by unwieldy <code>div</code>s. Tables are much easier to use, despite additional verbosity. But I have stuck to <code>div</code>s because it is &quot;the right thing to do&quot;. Thankfully my saving grace will soon be here. The 3rd revision the CSS standard supports a new <code>display</code> style. With it, one can specify that a div is to behave like a table, table row or table cell. Woohoo! Three cheers for tabley divs!!</p>

<p>This display style led me to think about semantic structure again. If we can designate that a <code>div</code> is a <code>table</code> structure via CSS, then why not any structure? And if <code>div</code>s, why not any tag? If we were able to do that, then semantic structure could be specified solely through CSS. And our HTML pages could go from rather simple, repetitive occurrences of <code>div</code> to ... can you guess?... pure XML.</p>

<p>Let&#39;s got through it step by step. Here some HTML [gist id=61726]:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml">    <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">&quot;ages&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;tr</span> <span class="na">class=</span><span class="s">&quot;person&quot;</span><span class="nt">&gt;&lt;td</span> <span class="na">class=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>John<span class="nt">&lt;/td&gt;&lt;td</span> <span class="na">class=</span><span class="s">&quot;age&quot;</span><span class="nt">&gt;</span>24<span class="nt">&lt;/td&gt;&lt;/tr&gt;</span>
      <span class="nt">&lt;tr</span> <span class="na">class=</span><span class="s">&quot;person&quot;</span><span class="nt">&gt;&lt;td</span> <span class="na">class=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Dean<span class="nt">&lt;/td&gt;&lt;td</span> <span class="na">class=</span><span class="s">&quot;age&quot;</span><span class="nt">&gt;</span>30<span class="nt">&lt;/td&gt;&lt;/tr&gt;</span>
    <span class="nt">&lt;/table&gt;</span>
</code></pre></div>
<p>Now with CSS 3 [gist id=61729]:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml">    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ages&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;person&quot;</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>John<span class="nt">&lt;/div&gt;&lt;div</span> <span class="na">class=</span><span class="s">&quot;age&quot;</span><span class="nt">&gt;</span>24<span class="nt">&lt;/div&gt;&lt;/div&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;person&quot;</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Dean<span class="nt">&lt;/div&gt;&lt;div</span> <span class="na">class=</span><span class="s">&quot;age&quot;</span><span class="nt">&gt;</span>30<span class="nt">&lt;/div&gt;&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

      .ages { display: table; }
    .person { display: table-row; }
      .name { display: table-cell; }
       .age { display: table-cell; }
</code></pre></div>
<p>Of course no one would recommend doing this to something that really is a table of data. But bare with me, because now we are coming full circle [gist id=61730]:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml">    <span class="nt">&lt;ages&gt;</span>
      <span class="nt">&lt;person&gt;&lt;name&gt;</span>John<span class="nt">&lt;/name&gt;&lt;age&gt;</span>24<span class="nt">&lt;/age&gt;&lt;/person&gt;</span>
      <span class="nt">&lt;person&gt;&lt;name&gt;</span>Dean<span class="nt">&lt;/name&gt;&lt;age&gt;</span>30<span class="nt">&lt;/age&gt;&lt;/person&gt;</span>
    <span class="nt">&lt;/ages&gt;</span>

      ages { display: table; }
    person { display: table-row; }
      name { display: table-cell; }
       age { display: table-cell; }
</code></pre></div>
<p>I think this is a rather remarkable outcome. And you might be surprised to learn that Firefox handles it just fine. What we have achieved is an ultra-clean separation between the data and it&#39;s semantic meaning, via XML, and it&#39;s semantic structure, via CSS. If this approach were embraced by the XHTML and CSS standards bodies, I would not be surprised to see it revolutionize web design.</p>

<hr>

<p>title      : XML. meet CSS
author     : trans
categories : [ruby]
date       : 2009-02-10
layout     : post</p>
</p>
            <div class="meta">
                Written By <address>trans</a> &mdash;
                <time pubdate datetime="2009-10-February" title="February 10, 2009">February 10, 2009</time>
            </div>
        </div>
        <hr>
    </section>
    
    
  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2009/01/24/what%27s-uf-got-on-xml/" rel="prefetch">Ruby AOP Made Simple</a></h2>
            <p><h1>What&#39;s &micro;F got on XML?</h1>

<p>Decisions, decisions. Therein lies the reason why convention over configuration is so bloody great, precisely because it requires fewer decisions. <a href="http://detroit.github.com/detroit">Detroit</a>, my awesome build tool, outputs log files. Yea, logs are good. But the decision I have to make is, &quot;in what format?&quot;</p>

<p>Now old-school would just put out some asterisk-studded text files with plenty of precise timestamps, maybe some nice long lines of dashes to divide things up. No doubt these files are easy to access and fairly readable. We like out text files. But hey wait. This is the age of magical markups. At the very least we can coax that log into a Wiki-tongue. For us Rubyists, we have rdoc, markdown and textile&#39;s just a few gemy fingertips away. These formats can be even easier to read thanks to structural consistency from log to log. Plus, fire-up a web server and we can get some really nice looking HTML too. That&#39;s the beauty of Wiki Wiki markup after all.</p>

<p>Now if beauty were all that matter, then there would be no point in looking further. But like America&#39;s continental shelves there is untapped wealth going to waste here. There is data in them there logs! The modern buzzword is <em>semantic</em>. Taking logs to the next level requires us to ensure their semantic value. On that account, XML was created, and long predicted the format of the future. Certainly XML has made great strides, but it is still far from meeting its promise. There is simply too much complexity involved in both marking up the content and in generating nice output.</p>

<p>Then comes along the <em>microformat</em>. The microformat combines the semantic capabilities of XML with the layout capabilities of HTML. Microformats are relatively new and still finding their footing. Indeed, I think a <em>Universal Uniform Microformat Specification</em> is ultimately the necessary outcome. In that vain I make a first rough estimate of what such unifying system might look like, and why, contrary to many arguments otherwise, microformats do in fact bring more to the table than XML.</p>

<p>Where XML provides semantic information within a doubly linked hierarchy (via attributes and body), microformats provide the same plus a set of well defined data structures. Microformats provide semantics through a small set of tag attributes, <em>role</em>, <em>rel</em>, <em>rev</em> and primarily the <em>class</em> attribute. The <em>class</em> attribute alone is enough to make microformats fully equatable to XML. We can easily map the same data set in either format:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml">    <span class="nt">&lt;people&gt;</span>
      <span class="nt">&lt;person&gt;</span>
        <span class="nt">&lt;name&gt;</span>John Jay<span class="nt">&lt;/name&gt;</span>
      <span class="nt">&lt;/person&gt;</span>
    <span class="nt">&lt;/people&gt;</span>
</code></pre></div>
<p>As opposed to...</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml">    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;people&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;person&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>John Jay<span class="nt">&lt;/span&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
</code></pre></div>
<p>Although the microformat is more verbose, the two contian the same original semantic value. But the extra verbosity isn&#39;t just a waste of UTF bytecodes, it says something. Specifically it gives us a <em>semantic structure</em>. It just so happens that HTML evolved to offer these structures precisely because that is what data presenters require to do their jobs well. And for the same reason, why you are always being beat with the <code>div</code>-stick when you try to take the load road of laying out your pages with tables.</p>

<p>So what semantic structures do micorformats via HTML make available to us? The quick rundown: we have layouts using <em>div</em> and <em>span</em>, lists using <em>ol</em>, <em>ul</em> and <em>li</em>; definition lists using <em>dl</em>, <em>dd</em> and <em>dt</em>; and tables using <em>table</em>, <em>tr</em>, <em>th</em> and <em>td</em>. Those are the obvious structures. There are still other smaller structure&#39;s like <em>a</em> for links, and the hefty set of <em>form</em> elements. All these elements provide us a way to say what type of thing our data is or partakes in, not just what the data is.</p>

<p>Clearly, the creators of XML saw the need for something like this and tried to achieve it through XML Namespaces. But namespaces are less effective because they are completely arbitrary, whereas HTML gives us a limited but universal structural language. Seems to me there is a principle to be found here that can be a guide for both the future of HTML and Microformats.</p>

<hr>

<p>title      : What&#39;s &micro;F got on XML?
author     : trans
categories : [website]
date       : 2009-01-24
layout     : post</p>
</p>
            <div class="meta">
                Written By <address>trans</a> &mdash;
                <time pubdate datetime="2009-24-January" title="January 24, 2009">January 24, 2009</time>
            </div>
        </div>
        <hr>
    </section>
    
    
  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2008/11/04/the-yadsl-rule/" rel="prefetch">Ruby AOP Made Simple</a></h2>
            <p><h1>The YADSL Rule</h1>

<p>Looks like the Ruby world is a fire with new DSLs for BDD/TDD. There&#39;s 
<a href="http://rspec.info/">RSpec</a>,
<a href="http://blog.zenspider.com/minitest/">minitest</a>,
<a href="http://test-unit.rubyforge.org/test-unit/">Test::Unit 2.x</a>,
<a href="http://test-spec.rubyforge.org/test-spec/">test-spec</a>,
<a href="http://www.oreillynet.com/ruby/blog/2008/02/assert2.html">Assert 2.0</a>,
<a href="http://expectations.rubyforge.org/">Expectations</a>,
<a href="http://github.com/aslakhellesoy/cucumber/tree/master">Cucumber</a>,
<a href="http://github.com/carlosbrando/remarkable/tree/master">Remarkable</a>,
<a href="http://www.thoughtbot.com/projects/shoulda/">Shoulda</a>
... woulda, coulda ... My word! So many choices. It&#39;s fitting that
it&#39;s Thanksgiving, what we have here is a <i>cornucopia of framework</i>!!!</p>

<p>Uh... Okay, you&#39;ll have to forgive me. I get carried away.</p>

<p>I suppose it all started with that RSpec. Those guys built an incredibly 
elaborate nomenclature to help us spell out our code&#39;s behaviors in gruesome
detail. But as wonderfully grandiose as it may be, there&#39;s just one tiny little
itty-bitty problem... <i>I can&#39;t remember it</i>. Oh, sure, I could sit down and
jam it into my already overloaded brain somewhere, but you know what. I ain&#39;t
gonna. I already have enough new stuff to learn and I&#39;m not going to bother to
learn another DSL when those I already know work just as well.</p>

<p>So therein lies the serious downside to any new DSL. They require more brain
cells. We&#39;re talking the old &quot;learning yet another language&quot; dilemma here. I was
thinking about this today, and it strikes me as one of those cool rules we oft
hear about. So I decided to &#39;writ&#39; one for the occasion.</p>

<blockquote>
  "Don't create a DSL if a native solution would be just as elegant."
</blockquote>

<p>In fact, a good DSL will likely need to be substantially more elegant in order
to fully justify its existence.</p>

<p>I&#39;m calling this the <i>YADSL Rule</i>, for &quot;Yet Another Domain Specific Language&quot;.</p>

<p>Now, a quick look around the world of modern programming 
(see <a href="http://dzone.com">DZone</a>),
just as quickly makes clear that the YADSL rule is in no short supply of
violations. Indeed, I dare say, that most of programming today is not innovative,
but masquerading around as such via YADSL.</p>

<p>Now I don&#39;t want to seem too harsh. There is of course a certain level of
refinement taking place in some areas. And that naturally has to play itself
out. But it&#39;s getting a little crazy. Besides test frameworks, web frameworks 
and Javscript development frameworks seem to have hit a New Cambrian Explosion.
I don&#39;t see how we&#39;re supposed to keep up with it.
I can only hope that my little rule might help to cool all
this exuberance down a bit; so we can catch our breaths and take some time
to consider the torrential downpour of verbiage that has befallen us.</p>

<p>Of course, the real problem may be that too many people want to make YANFT
(Yet Another Name For Themselves).</p>

<p>I swear to you. I&#39;m not one of them. But I will be introducing my own Ruby
test framework soon.</p>

<p>No. I&#39;m not kidding.</p>

<p>Don&#39;t worry, there&#39;s no new DSL to learn. And that&#39;s what makes my framework
so very special. I&#39;ll keep you posted.</p>

<!--
title      : The YADSL Rule
author     : trans
date       : 2008-11-04
categories : [yadsl, dsl, ruby]
layout     : post
-->
</p>
            <div class="meta">
                Written By <address>trans</a> &mdash;
                <time pubdate datetime="2008-04-November" title="November 04, 2008">November 04, 2008</time>
            </div>
        </div>
        <hr>
    </section>
    
    
  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2008/10/06/this-old-hash/" rel="prefetch">Ruby AOP Made Simple</a></h2>
            <p><h1>This Old Hash</h1>

<p>The Hash may well be the most used class in Ruby. Sure, our programs
have arrays and strings galore, but they generally come and go without
much ado. Hashes on the other hand get <em>used</em>; and by that I mean to
say, we spend a lot of time fussing with them. I think there are two
significant reasons for this and I will focus on the first, and
the more important of the two, here.</p>

<p>Now, I suspect you would agree, if I were to present you with a class
which was clearly overkill for vast majority of its intended uses, and
its use required repeated mitigation of its unused features, I have no
doubt, you&#39;d unequivocally advise me to select a &quot;<i>better tool for the job</i>&quot;.
And yet, that&#39;s the situation all Ruby programmers face, day in and
day out, with Ruby&#39;s Hash.</p>

<p>Ruby&#39;s Hash is exceptionally powerful because it supports any type of
object as a hash key. That&#39;s really really cool... for all of about
five minutes. The truth is, the vast majority of cases only require
one type of key --for Ruby that will either be a Symbol or a String,
and because of this, a great deal of time and code is wasted ensuring
all keys are that single type. Because of this, methods like 
<code>#to_sym</code> often riddle our scripts.</p>

<p>The issue is undeniably attested to by real world &quot;solutions&quot;
others have created to address it, such as Ruby Facets&#39;
<a href="http://facets.rubyforge.org/doc/api/core/classes/Hash.html#M000124">Hash#rekey</a>.
and Ruby on Rails&#39;
<a href="http://api.rubyonrails.org/classes/HashWithIndifferentAccess.html">HashWithIndifferentAccess</a>.
But let&#39;s face it, these are both underwhelming attempts at mitigating
the fundamental problem.</p>

<p>A real solution would have the current Hash class renamed, and a new
limited-key structure put in its place. The old class would still be
available, of course, for those special cases when a key of any object
type is required, but the new, more utilitarian Hash class would be
the literally-constructed default. The end effect of this change would
be simple:</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">    <span class="n">h</span><span class="o">[</span><span class="s1">&#39;a&#39;</span><span class="o">]</span> <span class="o">==</span> <span class="n">h</span><span class="o">[</span><span class="ss">:a</span><span class="o">]</span>
    <span class="n">h</span><span class="o">[</span><span class="s1">&#39;1&#39;</span><span class="o">]</span> <span class="o">==</span> <span class="n">h</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span>
</code></pre></div>
<p>This means reducing all hash keys to a single <em>symbolic</em> index type.
It does not matter what the actual reference is, a String, Symbol,
Integer, etc. just so long as it has a predictable symbolic
representation.</p>

<p>It may feel a bit strange to consider a suggestion that actually calls
for the reduction of features. More often change requests call for just
the opposite and YAGNI has to be peddled out on them. But, I think, we 
often underestimate the power of simplicity. Consider ideas such as 
convention-over-configuration and duck-typing --simplifications that
are not necessarily intuitive at first. But in the end, they make our
life as programmers a good bit more productive.</p>

<blockquote>
"Make everything as simple as possible, but not simpler."
<cite>--Albert Einstein</cite>
</blockquote>

<hr>

<p>title      : This Old Hash
author     : trans
date       : 2008-10-06
categories : [ruby, hash]
layout     : post</p>
</p>
            <div class="meta">
                Written By <address>trans</a> &mdash;
                <time pubdate datetime="2008-06-October" title="October 06, 2008">October 06, 2008</time>
            </div>
        </div>
        <hr>
    </section>
    
    
  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2008/09/28/if-and-oopy-if/" rel="prefetch">Ruby AOP Made Simple</a></h2>
            <p><h1>An Ally OOP for If-Conditions</h1>

<p>Ruby takes a unique approach to conditional evaluation: <i>All
objects are equivalent to <code>true</code> except <code>nil</code>
and <code>false</code></i>. No doubt this is a more object-oriented
approach than, say, C&#39;s use of <code>0</code> as false, but it&#39;s far
from the ideal of OOP all the way down, as any
<a href="http://pozorvlak.livejournal.com/94558.html">Smalltalker</a>
can attest.</p>

<p>Consider the following case. For a while now. I have wanted in my arsonal
of Ruby classes a NullClass defined basically as:</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">    <span class="k">class</span> <span class="nc">NullClass</span> <span class="o">&lt;</span> <span class="no">NilClass</span>
      <span class="k">def</span> <span class="nf">method_missing</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
        <span class="nb">self</span>
      <span class="k">end</span>
    <span class="k">end</span>

    <span class="no">NULL</span> <span class="o">=</span> <span class="no">NullClass</span><span class="o">.</span><span class="n">new</span>

    <span class="k">def</span> <span class="nf">null</span>
      <span class="no">NULL</span>
    <span class="k">end</span>
</code></pre></div>
<p>This object would greatly benefit fluent interfaces. Instead of returning
<code>nil</code>, such intefaces could return <code>null</code>, and no 
error would be thrown when invoking any method against it.</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">    <span class="n">obj</span> <span class="o">=</span> <span class="n">null</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">it</span><span class="o">.</span><span class="n">does</span><span class="o">.</span><span class="n">not</span><span class="o">.</span><span class="n">matter</span>  <span class="c1">#=&gt; null</span>
</code></pre></div>
<p>Unfortunately <code>null</code> is not very viable in Ruby
because <code>null</code> still evaluates as <code>true</code>
when used as the expression of a condition. The fact remains,
Ruby is hardcoded to see only the singleton instances of 
<code>NilClass</code> and <code>FalseClass</code> as false.</p>

<p>I&#39;ve requested that <code>NullClass</code> be added to core Ruby in
the past (as of yet to no avail) and though I still would like to
see it included, it may be better still to take an altogether 
object-oriented approach to conditions --in the spirit of Smalltalk.
This would allow us to freely create &quot;false&quot; objects, like the
<code>NullClass</code>, ourselves.</p>

<p>The adoption of such a capability does not require the odd syntax 
used by Smalltalk (<code>ifTrue</code> / <code>ifFalse</code>).
Rather, it can take an approach more akin to Ruby&#39;s own <code>case</code>
statements. As with <code>case</code>&#39;s use of <code>#===</code>,
a particular method would be used to evaluate the &quot;truthiness&quot; of
a value. This would apply for all types of conditions: 
<code>while</code>, <code>until</code>, etc. </p>

<p>To clarify, let&#39;s say this special method is simply called #if, then...</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">    <span class="k">class</span> <span class="nc">IfExample</span>
      <span class="kp">attr</span> <span class="ss">:if</span>
      <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="vi">@if</span><span class="p">)</span>
        <span class="vi">@if</span> <span class="o">=</span> <span class="k">if</span>
      <span class="k">end</span>
    <span class="k">end</span>

    <span class="n">x</span> <span class="o">=</span> <span class="no">IfExample</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="kp">false</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">x</span>
      <span class="s2">&quot;Yes&quot;</span>
    <span class="k">else</span>
      <span class="s2">&quot;No&quot;</span>
    <span class="k">end</span>
</code></pre></div>
<p>The result of this condition would be <code>&quot;No&quot;</code>.</p>

<p>While it may not be an earth shattering adjustment, the additional
flexibility opens up some interesting doors. Not only would classes
like the previously mentioned <code>NullClass</code> become possible,
but conditions themselves become <i>dynamically controllable</i>.</p>

<p>For example, it would allow method probes to fully map method
signatures (the Halting Problem not withstanding). This is not 
currently possible in Ruby because a probe cannot pretend to evaluate
to false in order to walk through the false side of a condition.</p>

<p>The idea would require some getting used to --after all a simple 
if-statement would no longer do what we Rubyists presently take 
for granted. But then, that&#39;s the nature of progress, is it not?</p>

<hr>

<p>title      : If and OOPy If
author     : trans
date       : 2008-09-28
categories : [ruby, nullclass]
layout     : post</p>
</p>
            <div class="meta">
                Written By <address>trans</a> &mdash;
                <time pubdate datetime="2008-28-September" title="September 28, 2008">September 28, 2008</time>
            </div>
        </div>
        <hr>
    </section>
    
    
  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2008/09/12/taskable/" rel="prefetch">Ruby AOP Made Simple</a></h2>
            <p><h1>Taskable</h1>

<p>On more than a few occasions I have taken a stab at writing a general
purpose task system, akin to Rake&#39;s, but one that works within the
framework of Ruby class inheritance. I recall my first attempt was
quite an unwieldy beast, and my subsequent attempts were fairly
unwieldy too, but over time they became more concise. Below is the
most concise variation yet, and I was wondering what other thought
of it -- do you see any flaws in the design; does it satisfy all the
criteria of such a system; would you find it useful; etc.</p>

<p>One issue to note about the code, is the use of the <code>*_trigger</code> methods.
I&#39;m not sure that&#39;s the best approach. My original approach was
to provide a #run method (you can see it commented out), but this
requires dividing Taskable into two parts, a module for extending and
a module for including, and I try to avoid that design when I can.</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">    <span class="k">module</span> <span class="nn">Taskable</span>

      <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">append_features</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
        <span class="n">base</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span>
      <span class="k">end</span>

      <span class="c1"># Without an argument, returns list of tasks defined for this class.</span>
      <span class="c1">#</span>
      <span class="c1"># If a task&#39;s target name is given, will return the first</span>
      <span class="c1"># task matching the name found in the class&#39; inheritance chain.</span>
      <span class="c1"># This is important to ensure tasks are inherited in the same manner</span>
      <span class="c1"># that methods are.</span>
      <span class="k">def</span> <span class="nf">tasks</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="kp">nil</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">target</span>
          <span class="n">target</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">to_sym</span>
          <span class="n">anc</span> <span class="o">=</span> <span class="nb">ancestors</span><span class="o">.</span><span class="n">select</span><span class="p">{</span><span class="o">|</span><span class="n">a</span><span class="o">|</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="no">Taskable</span><span class="p">}</span> <span class="c1">#DSL</span>
          <span class="n">t</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">;</span> <span class="n">anc</span><span class="o">.</span><span class="n">find</span><span class="p">{</span><span class="o">|</span><span class="n">a</span><span class="o">|</span> <span class="n">t</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">tasks</span><span class="o">[</span><span class="n">target</span><span class="o">]</span><span class="p">}</span>
          <span class="k">return</span> <span class="n">t</span>
        <span class="k">else</span>
          <span class="vi">@tasks</span> <span class="o">||=</span> <span class="p">{}</span>
        <span class="k">end</span>
      <span class="k">end</span>

      <span class="c1"># Set a description to be used by then next defined task in this class.</span>
      <span class="k">def</span> <span class="nf">desc</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
        <span class="vi">@desc</span> <span class="o">=</span> <span class="n">description</span>
      <span class="k">end</span>

      <span class="c1"># Define a task.</span>
      <span class="k">def</span> <span class="nf">task</span><span class="p">(</span><span class="n">target_and_requisite</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">function</span><span class="p">)</span>
        <span class="n">target</span><span class="p">,</span> <span class="n">requisite</span><span class="p">,</span> <span class="n">function</span> <span class="o">=</span> <span class="o">*</span><span class="no">Task</span><span class="o">.</span><span class="n">parse_arguments</span><span class="p">(</span><span class="n">target_and_requisite</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">function</span><span class="p">)</span>
        <span class="n">task</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">[</span><span class="n">target</span><span class="o">.</span><span class="n">to_sym</span><span class="o">]</span> <span class="o">||=</span> <span class="p">(</span>
          <span class="n">tdesc</span> <span class="o">=</span> <span class="vi">@desc</span>
          <span class="vi">@desc</span> <span class="o">=</span> <span class="kp">nil</span>
          <span class="no">Task</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="nb">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">tdesc</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">task</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">requisite</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">function</span><span class="p">)</span>
        <span class="n">define_method</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">target</span><span class="si">}</span><span class="s2">_trigger&quot;</span><span class="p">){</span> <span class="n">task</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span> <span class="p">}</span>  <span class="c1"># or use #run?</span>
        <span class="n">define_method</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">target</span><span class="si">}</span><span class="s2">:task&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">function</span><span class="p">)</span> <span class="c1"># TODO: in 1.9 use instance_exec instead.</span>
      <span class="k">end</span>

      <span class="c1"># Run a task.</span>
      <span class="c1"># Hmmm... to add this would require another module (to include).</span>
      <span class="c1"># But I&#39;m not sure. Maybe trigger method is the better way?</span>
      <span class="c1">#</span>
      <span class="c1">#def run(target)</span>
      <span class="c1">#  #t = self.class.tasks(target)</span>
      <span class="c1">#  #t.run(self)</span>
      <span class="c1">#  send(&quot;#{target}_trigger&quot;)</span>
      <span class="c1">#end</span>

      <span class="c1"># = Task Class</span>
      <span class="c1">#</span>
      <span class="k">class</span> <span class="nc">Task</span>
        <span class="kp">attr</span> <span class="ss">:base</span>
        <span class="kp">attr</span> <span class="ss">:target</span>
        <span class="kp">attr</span> <span class="ss">:requisite</span>
        <span class="kp">attr</span> <span class="ss">:function</span>
        <span class="kp">attr</span> <span class="ss">:description</span>

        <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kp">nil</span><span class="p">,</span> <span class="n">requisite</span><span class="o">=</span><span class="kp">nil</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">function</span><span class="p">)</span>
          <span class="vi">@base</span>        <span class="o">=</span> <span class="n">base</span>
          <span class="vi">@target</span>      <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">to_sym</span>
          <span class="vi">@description</span> <span class="o">=</span> <span class="n">description</span>
          <span class="vi">@requisite</span>   <span class="o">=</span> <span class="n">requisite</span> <span class="o">||</span> <span class="o">[]</span>
          <span class="vi">@function</span>    <span class="o">=</span> <span class="n">function</span>
        <span class="k">end</span>

        <span class="c1">#</span>
        <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">requisite</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">function</span><span class="p">)</span>
          <span class="vi">@requisite</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">requisite</span><span class="p">)</span><span class="o">.</span><span class="n">uniq!</span>
          <span class="vi">@function</span> <span class="o">=</span> <span class="n">function</span> <span class="k">if</span> <span class="n">function</span>
        <span class="k">end</span>

        <span class="c1">#</span>
        <span class="k">def</span> <span class="nf">prerequisite</span>
          <span class="n">base</span><span class="o">.</span><span class="n">ancestors</span><span class="o">.</span><span class="n">select</span><span class="p">{</span> <span class="o">|</span><span class="n">a</span><span class="o">|</span> <span class="n">a</span><span class="o">.</span><span class="n">is_a?</span><span class="p">(</span><span class="no">Taskable</span><span class="p">)</span> <span class="p">}</span><span class="o">.</span><span class="n">collect</span><span class="p">{</span> <span class="o">|</span><span class="n">a</span><span class="o">|</span>
            <span class="n">a</span><span class="o">.</span><span class="n">tasks</span><span class="o">[</span><span class="n">target</span><span class="o">].</span><span class="n">requisite</span>
          <span class="p">}</span><span class="o">.</span><span class="n">flatten</span><span class="o">.</span><span class="n">uniq</span>
        <span class="k">end</span>

        <span class="c1"># invoke target</span>
        <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">object</span><span class="p">)</span>
          <span class="n">rd</span> <span class="o">=</span> <span class="n">rule_dag</span>
          <span class="n">rd</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
            <span class="n">object</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">t</span><span class="si">}</span><span class="s2">:task&quot;</span><span class="p">)</span>
          <span class="k">end</span>
        <span class="k">end</span>

        <span class="c1">#</span>
        <span class="c1">#def call(object)</span>
        <span class="c1">#  object.instance_eval(&amp;function)</span>
        <span class="c1">#end</span>

        <span class="c1"># Collect task dependencies for running.</span>
        <span class="k">def</span> <span class="nf">rule_dag</span><span class="p">(</span><span class="n">cache</span><span class="o">=[]</span><span class="p">)</span>
          <span class="n">prerequisite</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">r</span><span class="o">|</span>
            <span class="k">next</span> <span class="k">if</span> <span class="n">cache</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">tasks</span><span class="o">[</span><span class="n">r</span><span class="o">]</span>
            <span class="n">t</span><span class="o">.</span><span class="n">rule_dag</span><span class="p">(</span><span class="n">cache</span><span class="p">)</span>
            <span class="c1">#cache &lt;&lt; dep</span>
          <span class="k">end</span>
          <span class="n">cache</span> <span class="o">&lt;&lt;</span> <span class="n">target</span><span class="o">.</span><span class="n">to_s</span>
          <span class="n">cache</span>
        <span class="k">end</span>

        <span class="c1">#</span>
        <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">parse_arguments</span><span class="p">(</span><span class="n">name_and_reqs</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">action</span><span class="p">)</span>
          <span class="k">if</span> <span class="no">Hash</span><span class="o">===</span><span class="n">name_and_reqs</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">name_and_reqs</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">to_s</span>
            <span class="n">reqs</span> <span class="o">=</span> <span class="o">[</span><span class="n">name_and_reqs</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">first</span><span class="o">].</span><span class="n">flatten</span>
          <span class="k">else</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">name_and_reqs</span><span class="o">.</span><span class="n">to_s</span>
            <span class="n">reqs</span> <span class="o">=</span> <span class="o">[]</span>
          <span class="k">end</span>
          <span class="k">return</span> <span class="n">target</span><span class="p">,</span> <span class="n">reqs</span><span class="p">,</span> <span class="n">action</span>
        <span class="k">end</span>
      <span class="k">end</span>
    <span class="k">end</span>
</code></pre></div>
<p>Here&#39;s a very simple <a href="http://quarry.rubyforge.org">QEDoc</a> demo/spec:</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">    <span class="k">class</span> <span class="nc">Example</span>
      <span class="kp">include</span> <span class="no">Taskable</span>

      <span class="n">task</span> <span class="ss">:task_with_no_requisites</span> <span class="k">do</span>
        <span class="n">cache</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;task_with_no_requisites&quot;</span>
      <span class="k">end</span>

      <span class="n">task</span> <span class="ss">:task_with_one_requisite</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="ss">:task_with_no_requisites</span><span class="o">]</span> <span class="k">do</span>
        <span class="n">cache</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;task_with_one_requisite&quot;</span>
      <span class="k">end</span>

      <span class="k">def</span> <span class="nf">cache</span>
        <span class="vi">@cache</span> <span class="o">||=</span> <span class="o">[]</span>
      <span class="k">end</span>
    <span class="k">end</span>

    <span class="n">example</span> <span class="o">=</span> <span class="no">Example</span><span class="o">.</span><span class="n">new</span>
    <span class="c1">#example.run :task_with_no_requisites</span>
    <span class="n">example</span><span class="o">.</span><span class="n">task_with_no_requisites_trigger</span>
    <span class="n">example</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">assert</span> <span class="o">==</span> <span class="o">[</span><span class="s2">&quot;task_with_no_requisites&quot;</span><span class="o">]</span>

    <span class="n">example</span> <span class="o">=</span> <span class="no">Example</span><span class="o">.</span><span class="n">new</span>
    <span class="c1">#example.run :task_with_one_requisite</span>
    <span class="n">example</span><span class="o">.</span><span class="n">task_with_one_requisite_trigger</span>
    <span class="n">example</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">assert</span> <span class="o">==</span> <span class="o">[</span><span class="s2">&quot;task_with_no_requisites&quot;</span><span class="p">,</span> <span class="s2">&quot;task_with_one_requisite&quot;</span><span class="o">]</span>
</code></pre></div>
<p>So, what do you think?</p>

<hr>

<p>title      : Taskable
date       : 2008-09-12
categories : [ruby]
layout     : post</p>
</p>
            <div class="meta">
                Written By <address>trans</a> &mdash;
                <time pubdate datetime="2008-12-September" title="September 12, 2008">September 12, 2008</time>
            </div>
        </div>
        <hr>
    </section>
    
    
  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2007/05/02/the-library-poll/" rel="prefetch">Ruby AOP Made Simple</a></h2>
            <p><h1>The Library Poll</h1>

<p>I&#39;ve been thinking far too long about how best to organize and distribute programming libraries. Having a hard time coming to any firm conclusions, I&#39;ve decided to try an inductive approach --via a poll. If you have a moment, I&#39;d really appreciate your thoughtful answers to the following questions. Thanks!</p>

<p><strong>Sorry, the polls are closed</strong>. But here are the results:</p>

<p>1) Which library name would you prefer: (<code>126</code> votes)</p>

<ul>
<li><code>37%</code> livelibs-file</li>
<li><code>63%</code> filestorm</li>
</ul>

<p>2) Which library would you be more likely to try: (<code>204</code> votes)</p>

<ul>
<li><code>62%</code> cliutils</li>
<li><code>10%</code> cli/best</li>
<li><code>03%</code> cliBest</li>
<li><code>24%</code> climax</li>
</ul>

<p>3) Should programming libraries be named: (<code>211</code> votes)</p>

<ul>
<li><code>45%</code> Creatively</li>
<li><code>55%</code> Categorically</li>
</ul>

<p>4) Programming libraries should be packaged: (<code>200</code> votes)</p>

<ul>
<li><code>35%</code> Per specific tool</li>
<li><code>47%</code> Per related set of tools</li>
<li><code>18%</code> Comprehensively (all-in-one)</li>
</ul>
</p>
            <div class="meta">
                Written By <address>trans</a> &mdash;
                <time pubdate datetime="2007-02-May" title="May 02, 2007">May 02, 2007</time>
            </div>
        </div>
        <hr>
    </section>
    
    
  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2007/03/12/package-management-is-a-red-herring/" rel="prefetch">Ruby AOP Made Simple</a></h2>
            <p><h1>Package Management is a Red Herring</h1>

<p>Traditionally package management has been fairly complicated. Developers must navigate the matrix of platform support, package format and configuration choices that are often as time consuming as they are restrictive. </p>

<p>For instance, the goto format of the day on most Linux platforms is the Debian package format. Debian packages follow closely to the <code>FHS</code> (File Hierarchy standard), and tend to enforce fairly strict Debian packaging policies, such as placing development files in separate packages. Debian packages require the creation of a control file with information about the build as well as a &quot;fuax installation&quot; that is packaged up into a <code>.deb</code> file. All of this takes a fair bit of effort on the developer&#39;s part. And that&#39;s just the work involved for supporting one package format for a limited selection of platforms.</p>

<p>For Ruby developers, RubyGems has come along to make life a fair bit easier. They have dispensed with FHS compliance, to the dismay if Debian maintainers, and provided a relatively easy means of packaging up a library or application for redistribution by following the <em>convention over configuration</em> philosophy. Of course, it helps that the target source is Ruby, which has very simple file-based import system, as opposed to C or Java.</p>

<p>Even so, package management can be even easier if we simply recognize the gorilla in the room: version control systems. All developers now use source code managers (<code>SCM</code>) to track changes to code and <em>distribute</em> source between developers. See the keyword there? The ability to <em>distribute</em> a program is half the battle of package management.</p>

<p>The other half is installation. For a pure-Ruby program installation if fairly trivial, it&#39;s just a matter to putting the files in a proper location on the file system. For C or Java packages there is the further matter of the <em>compile</em>. For open-source projects that&#39;s not particularly difficult, a build script can be provided and as long as the end installer has the necessary build tools, the program can be compiled on demand. For proprietary code it gets more complicated, but lets put that aside for the moment.</p>

<p>Taking all of this into consideration, packaging systems should be fairly trivial --a wrapper around SCM tools that pull down the current or tagged version of source, run the build script and copy the resulting files to an appropriate place on disk. Such a system would be very light weight. In fact, with the exception of dependency management code, there&#39;s no reason that such a system to take up more than a few hundred lines of code.</p>

<p>The question of proprietary code is a little more challenging since the developer does not want the source code to make it&#39;s way to the end-users system at all. In this case I suggest one of two possibilities: 1) it may be possible to use encryption to prevent end-users from gaining access to the source, or 2) use an intermediary service that builds a package on a replica of the end users machine, turning over only the final results. Yes, this means complications for proprietary vendors, but it&#39;s one that could easily be turned into a service.</p>

<p>The chore of the developer could then be greatly reduced to following a set of standards for organizing a project, providing metadata and optionally a build script for handling advanced build requirements. The target platform can take these pieces and build and install the package as is suitable to the platform. In other words, the platform takes care of the platform distinctions, not the developer.</p>
</p>
            <div class="meta">
                Written By <address>trans</a> &mdash;
                <time pubdate datetime="2007-12-March" title="March 12, 2007">March 12, 2007</time>
            </div>
        </div>
        <hr>
    </section>
    
    
  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2006/11/11/we-all-live-in-a-yellow-submarine/" rel="prefetch">Ruby AOP Made Simple</a></h2>
            <p><h1>We All Live in a Yellow Submarine</h1>

<p>Anyone having read my previous posts, here and on ruby-talk, knows I love to explore ideas. It doesn&#39;t matter if they are considered &quot;good&quot; or &quot;bad&quot;. Most cannot be judged without first exponding on them anyway. In fact, half the time I have no idea where an idea might lead until I sit down and blog it.</p>

<p>Tonight&#39;s idea comes by way of frustration with project organization, specifically module namespaces. A minor issue for small projects; large projects on the other hand... Well, consider my current problem. I have a class called Project. Now related to Project are a number of modularized tool sets. Each tool set can be used independently of the Project class, but typically will be used via it. So where do I locate the tool sets? My first instinct is to go ahead and put them in the class itself.</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">  <span class="k">module</span> <span class="nn">MyApp</span>
    <span class="k">class</span> <span class="nc">Project</span>
      <span class="k">module</span> <span class="nn">ToolSetA</span>
      <span class="k">module</span> <span class="nn">ToolSetB</span>
</code></pre></div>
<p>But I find this less the optimal. While it may be a small and unlikely matter, class is not a bonofide namespace --it is a class. And while it depends on these tool sets, the tool sets do not necessarily depend on it. As such we would never be able to include these tool sets in another namespace --such as the toplevel if it struck my or some users fancy. So we are left then to use some alternate organization.</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">   <span class="k">class</span> <span class="nc">Project</span>
   <span class="k">module</span> <span class="nn">ProjectToolsets</span>
     <span class="k">module</span> <span class="nn">ToolSetA</span>
     <span class="k">module</span> <span class="nn">ToolSetB</span>
</code></pre></div>
<p>or as a compromise</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">   <span class="k">class</span> <span class="nc">Project</span>
     <span class="k">module</span> <span class="nn">Toolsets</span>
       <span class="k">module</span> <span class="nn">ToolSetA</span>
       <span class="k">module</span> <span class="nn">ToolSetB</span>
</code></pre></div>
<p>The downside here, of course, are the long-winded names. But a better solution eludes me, other than one possibility: the use of all capitals for pure namespace modules.</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">   <span class="k">class</span> <span class="nc">Project</span>
   <span class="k">module</span> <span class="nn">PROJECT</span>
     <span class="k">module</span> <span class="nn">ToolSetA</span>
     <span class="k">module</span> <span class="nn">ToolSetB</span>
</code></pre></div>
<p>It&#39;s a bit strange in appearance but it works well. One quark however is that this new rule begs for my project&#39;s toplevel namepsace to be all caps too. Do I want to go there?</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">  <span class="k">module</span> <span class="nn">MYAPP</span>
   <span class="k">class</span> <span class="nc">Project</span>
   <span class="k">module</span> <span class="nn">PROJECT</span>
     <span class="k">module</span> <span class="nn">ToolSetA</span>
     <span class="k">module</span> <span class="nn">ToolSetB</span>
</code></pre></div>
<p>I&#39;m not sure it&#39;s the solution I&#39;m after, but to its merit, it does draw a nice distinction between namespace modules and other modules and classes.</p>

<p>In the course of this consideration I began to wonder about the distinction between Class and Module. The difference is almost not-existent in reality. If you peer into the Ruby source code you will find that interoperability between them is purposefully prevented. After all Class is a subclass of Module. Yet they are made distinct for a good reason. They provide conceptually different ideas. A class represents an data archetype; a module represents a reusable component. In fact, one could easily argue that Module itself could use an additional distiction between Namespace and Mixin. Even so, I could not help but wonder if it might yet be possible to have a single Encapsulation, relegating the differences to the elements within them instead of the encapsulation types themselves. I imagined this:</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">  <span class="k">class</span> <span class="nc">Something</span>
    <span class="k">def</span> <span class="nf">x</span>
    <span class="k">def</span> <span class="nf">y</span>
    <span class="n">mod_def</span> <span class="n">a</span>
    <span class="n">mod_def</span> <span class="n">x</span>
    <span class="k">class</span> <span class="nc">SomethingElse</span>
</code></pre></div>
<p>Instantiating via Something.new or subclassing would provide the instance methods x and y. Including however would provide the mod<em>def methods a and x instead along with adding SomethingElse to the including namespace. More refined means of controlling namespace become possible. For instance include</em>constants could limit inclusion to constants only; vice-verse with include<em>methods. Methods could be defined as both instance and module methods. And while we&#39;re at it, throw in a class</em>def as an alternative to def self.x.</p>

<p>It&#39;s interesting. I&#39;ve often thought about the idea of eliminating the distinction between Class and Module. This is the first time it&#39;s occurred to me that it could be done while retaining the utility of that distinction by passing responsibility down to the methods themselves.</p>

<p>I suppose now the question is, what are the downsides to this? That&#39;ll require further consideration, but one clear point is that methods are less cleanly divided. You could have module methods scattered about your class definitions, weaving in and out of your instance methods. I suspect we would make an effort to nicely organize them however. Besides it means having fewer modules to name --and I&#39;m all for anything that reduces the number of names I have to make-up.</p>

<p>It would be interesting to see how far one could go in implementing this in pure Ruby. Some details of Ruby will hold back a perfect implementation, but the essence of it is certainly possible. For starters, here&#39;s a neat trick for doing without the distinction between class and module.</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">  <span class="k">class</span> <span class="nc">Module</span>
    <span class="k">def</span> <span class="nf">new</span>
      <span class="n">mod</span> <span class="o">=</span> <span class="nb">self</span>
      <span class="no">Class</span><span class="o">.</span><span class="n">new</span><span class="p">{</span> <span class="kp">include</span> <span class="n">mod</span> <span class="p">}</span><span class="o">.</span><span class="n">new</span>
    <span class="k">end</span>
  <span class="k">end</span>
</code></pre></div>
<p>Have fun! Unfortunately I&#39;m not. I&#39;m still stuck on the forementioned namespace issue! Oh well. Back to the coding board...</p>
</p>
            <div class="meta">
                Written By <address>trans</a> &mdash;
                <time pubdate datetime="2006-11-November" title="November 11, 2006">November 11, 2006</time>
            </div>
        </div>
        <hr>
    </section>
    
    
  
    <section class="index">
        <!-- -->
        <div>
            <h2 class="title"><a href="/2006/08/26/the-persnickety-order-of-self-serving-modules/" rel="prefetch">Ruby AOP Made Simple</a></h2>
            <p><h1>The Persnickety Order of Self-Serving Modules</h1>

<p>This one caught me off guard.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  irb(main):001:0&gt; module M
  orb(main):002:1&gt;   def x; &quot;x&quot;; end
  orb(main):003:1&gt; end
  =&gt; nil
  orb(main):005:0&gt; module Q
  orb(main):006:1&gt;   extend self
  orb(main):007:1&gt;   include M
  orb(main):008:1&gt; end
  =&gt; Q
  orb(main):009:0&gt; Q.x
  NoMethodError: undefined method `x&#39; for Q:Module
          from (orb):9
          from :0
</code></pre></div>
<p>Why isn&#39;t the included #x coming along for the ride in the self extension of Q? This kind of dyanmicism is vital when dynamically loading behaviors. And so I suspect it must do with the dread <a href="http://groups.google.com/group/comp.lang.ruby/msg/70509b289f0ea999">Dynamic Module Inclusion Problem</a>? And it would appear that I am right:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  orb(main):012:0&gt; module M
  orb(main):013:1&gt;   def x; &quot;x&quot;; end
  orb(main):014:1&gt; end
  =&gt; nil
  orb(main):015:0&gt; module Q
  orb(main):016:1&gt;   include M
  orb(main):017:1&gt;   extend self
  orb(main):018:1&gt; end
  =&gt; Q
  orb(main):019:0&gt; Q.x
  =&gt; &quot;x&quot;
</code></pre></div>
<p>Yes, another of the edge cases. But the preponderance weighs heavy on the Coding Spirit. The Dynamic Module Inclusion Problem is getting old.</p>
</p>
            <div class="meta">
                Written By <address>trans</a> &mdash;
                <time pubdate datetime="2006-26-August" title="August 26, 2006">August 26, 2006</time>
            </div>
        </div>
        <hr>
    </section>
    
    
    <section class="pagination" style="text-align:center">
      
        
        <a href="/page6" class="btn btn-outline">‹ Newer</a>
        
      
      
        <a href="/page8" class="btn btn-outline">Older ›</a>
      
    </section>
</article>


<footer class="site-footer">
    <div class="container">
        &copy; 2014 
        
        <nav>
            <a href="http://tabcomputing.com/">Tab Computing</a> &middot;
            <a href="/">Blog</a> &middot;
            <a href="http://incorporated.sendtoinc.com/">Product</a> &middot; 
            <a href="https://tabcomputing.com/about/">About</a>
        </nav>
        
        <nav class="social">
            
                
            <a href="/feed.xml" title="RSS Feed">
                <i class="icon icon-rss black"></i>
            </a>
        </nav>
        <p>Incorporated theme by <a href="https://sendtoinc.com">Inc</a></p>
    </div>
</footer>

<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="/assets/main.js"></script>






</body>
</html>
