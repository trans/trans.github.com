
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />

  <title>7ranscode</title>

  <!-- google verification-->
  <meta name="verify-v1" content="p14vW7GGMohDo2YKUHm0SXXTL+tzyPbKxxp35/WIQLA=" />

  <meta name="DESCRIPTION"
        content="Brite is a K.I.S.S. website builder."/>

  <link rel="icon" href="/images/trans-logo.png" type="image/x-icon" />

  <link href="atom.xml" rel="alternate" title="blog.webrite.rubyforge.org" type="application/atom+xml" />

  <!-- STYLESHEETS -->

  <link href="/styles/reset.css"  rel="stylesheet" type="text/css" />
  <link href="/styles/screen.css" rel="stylesheet" type="text/css" media="screen, projection" />
  <link href="/styles/print.css"  rel="stylesheet" type="text/css" media="print" />

  <!--[if IE]>
      <link href="/ie.css" media="screen, projection" rel="stylesheet" type="text/css" />
  <![endif]-->

  <link href="/styles/tag.css"    rel="stylesheet" type="text/css" />
  <link href="/styles/class.css"  rel="stylesheet" type="text/css" />

  <link href="/styles/syntax.css"  rel="stylesheet" type="text/css" />

  <!-- <script src="js/rdocs.js" type="text/javascript"></script> -->
</head>
<body>

<div id="header">
  <div id="header-inner">
    <div class="title">
      <img class="logo" src="/images/transcode.png" width="480px" align="top" />
    </div>
    <div class="menu" style="text-align: left;">
      <div class="menu-inner">
        <a href="/index.html">Home</a> &middot;
        <a href="/tags.html">Tags</a> &middot;
        <a href="/puddy.html">Puddy</a> &middot;
        <a href="/about.html">About</a>
      </div>
    </div>
  </div>
</div>

<div class="doc">
  
<div class="page">

  <div class="article-title">
    Gem Crazy
    <span style="font-size: 0.5em;">
    <a href="http://trans.github.com/20100515-gemcrazy/index.html#disqus_thread">Comments</a>
    </span>
  </div>

  <p><b>I believe the Ruby community may have finally gone off the rails in it's collective
crazy train.</b> I have been reading about <a href="http://gembundler.com/">Bundler</a>,
the spiffy new RubyGems manager to be default part of Rails 3.0, and I can't help but
wonder what track we were even on.</p>

<p>If you don't know about Bundler yet, you can learn about it
<a href="http://yehudakatz.com/2009/11/03/using-the-new-gem-bundler-today/">here</a>.
I imagine most of you are already aware of it and are now considering how it fits in
with your future development plans. So I want so ask a more fundamental question:
Why does Bundler even exist?</p>

<p>On the surface, we can of course thank Rails. The deployment of web applications
stands apart from the distribution of Ruby packages. Deploying a Rails
application usually means copying an app's files up to a server, as opposed to
creating a distributable package file (like a gem) and installing that on
the remote machine. Technically the later could be done, but it isn't, probably
because most web apps are proprietary and do not need wider distribution. Because
Rails developers do not use the normal RubyGems distribution mechanism, which
automatically installs dependencies, they need another way to ensure their apps
dependencies are present, hence the convenience of <code>bundle install</code>.</p>

<p>Bundler achieves this goal in a grand fashion. As its name implies
it does so by giving us the means to download the gems an application is dependent
upon and store them directly within the project itself. These gems get stored in
a project's <code>vendor/gems/</code> directory. The rationalized benefit being
that you need never worry about remote services going down (e.g. <code>rubygems.org</code>)
in order to deploy your application, nor ever worry about any potential changes
in a dependent gem. So in brief, one can <em>bundle</em> dependent gems with ones
application.</p>

<p>At first blush it seem like great idea. After all developers use vendoring to
do something similar while developing an application. But lets consider this
a bit more carefully. The worry of a remote service going down is, honestly, bordering
on paranoia. That's why mirrors of RubyGems.org exist. If one goes down, the others
remain. The odds of all mirrors going down at the same time are extremely small, and
as you might imagine, such a situation would be corrected very quickly, if it ever did
occur. In fact, if it did happen, there is a fair chance your host will be down too.
So the solution here is not bundling, but redundancy. As for the fear
of "monkey releases" --new versions of a gem that that might break things,
this is somewhat understandable, but redistributing every dependency with each app
is shear overkill. If you are that concerned a gem will break an application you can
always specify exact requirements in the gemspec, and use the <code>gem</code> method to nail the
version down. That, in fact, is the whole point of the <code>gem</code> method. And it is a
perfectly good solution for applications such as a Rails app. Unfortunately is not
a very good solution for general purpose libraries. (As can be read about in any number
of blog posts by searching
<a href="http://www.google.com/search?q=Don%27t+require+%27rubygems%27">Don't require 'rubygems'</a>.)</p>

<p>[Update: I have been informed that the real benefit of bundling is to make
it easier to install an application on machines that has limited Internet access.
In such cases, I can see that Bundler might be handly.]</p>

<p>I should mention that the latest version of Bundler (v0.9) has a light-weight rendition
of bundling, called <em>locking</em>, which doesn't actually store the gem in the application,
but automatically locks the gems your application uses to specific versions. In other
words, it generates a file which (I assume) will ulitmately be used with the <code>gem</code> method
to nail down the exact versions of gems your application is using at that time of the lock.
This is a much better approach than bloating your application with .gem files, to achieve
the same end, and to Bundler's credit it makes it easy to keep those <code>gem</code> calls current.
However, it still ties your program to RubyGems, so again it's not a perfect solution
for reusable libraries.</p>

<p>Another feature Bundler sets out to handle are <em>groups</em>. They are "gem environments"
which can be loaded as a collective, or even omitted during an install. In other words,
they are a way to specify a specific group of gems to the <code>bundle</code> command or in ones
code with <code>Bundler.require</code>. The most common groups you are likely to see are <code>runtime</code>
or <code>production</code>, <code>test</code> and <code>development</code>, patterned after Rails own database
environments. While I will not dismiss out-of-hand the potential of deriving some
utility from this feature, on the whole I suspect it is a YAGNI. Moreover,
it exposes the developer to even more potential deployment errors. I can only
imagine the failures that will arise because a testing environment
had a gem that the runtime environment forgot to add, but actually needed.</p>

<p>In addition, the use of Bundler promotes the use of <code>Bundler.require</code>. How many
countless hours have been spent reminding people not to put <code>require 'rubygems'</code>
in their lib code? Now the issue will be doubly compounded. While we can hope
that Bundler never makes it's way beyond Rails (or at least end-user apps), I have
already seen it in at least two non-Rails programs.</p>

<p>Lastly, Bundler also provides an ability to depend on git repos, so long as
they track a .gemspec. This feature is a clear address to vendoring, but
via gem dependencies. I won't even go into all the issues that arise with this
(and seems to somewhat contradict Bundler's primary purpose --or at least compound its need!).
You can read some of the back and forth on this idea <a href="http://yehudakatz.com/2010/04/02/using-gemspecs-as-intended/">here</a>.
I will say, however, what really strikes me most about this is
how an unproven system takes on such fanfare that it's proponents now declare we have
all been doing it wrong! A <code>.gemspec</code> should never be generated by some "extraneous
build tool", but ought to be edited by hand and checked into the scm repository. Wow.</p>

<p>I realized the Bundler is addressing certain needs, primarily of the Rails community.
The problem with Bundler is that it is trying to correct something that is fundamentally
problematic from the start. On two fronts... The first being that RubyGems ties
a packaging system to versioning, so using the <code>gem</code> command will never be a universally
applicable solution to lock down versions. And the second, more significant issue, that RubyGems,
and hence Bundler, cannot avoid <b>version conflicts</b>. RubyGems blows-up when it
encounters a conflict. Bundler only mitigates this issue by selectin suiable version before
runtime. But niether allow different versions to run simultatneously. This is the real heart
of the matter, and it stems from the fundamental lack of version support in Ruby itself.
In my opinion, until that is addressed, all of these fancy solutions are simply trains headed
up the wrong track.</p>


  <small>Written by trans, 2010-05-15</small>

  <ul class="posts">
    
    
  </ul>

  <br/><br/>

  <!-- Commment vis Disqus -->
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    /**
      * var disqus_identifier; [Optional but recommended: Define a unique identifier (e.g. post id or slug) for this thread] 
      */
    (function() {
     var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
     dsq.src = 'http://transcode.disqus.com/embed.js';
     (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=transcode">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

</div>


</div>

<br style="clear: both;"/><br/><br/>

<div class="footer">
<div class="footer-inner">
  Copyright (c) 2005,2009 Thomas Sawyer
</div>
</div>

<!-- Disqus Comment Counter -->
<script type="text/javascript">
//<![CDATA[
(function() {
	var links = document.getElementsByTagName('a');
	var query = '?';
	for(var i = 0; i < links.length; i++) {
	if(links[i].href.indexOf('#disqus_thread') >= 0) {
		query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
	}
	}
	document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/transcode/get_num_replies.js' + query + '"></' + 'script>');
})();
//]]>
</script>

<!-- Google Analytics -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-2883355-2";
urchinTracker();
</script>

</body>
</html>

