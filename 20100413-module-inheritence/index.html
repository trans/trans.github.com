
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />

  <title>7ranscode</title>

  <!-- google verification-->
  <meta name="verify-v1" content="p14vW7GGMohDo2YKUHm0SXXTL+tzyPbKxxp35/WIQLA=" />

  <meta name="DESCRIPTION"
        content="Brite is a K.I.S.S. website builder."/>

  <link rel="icon" href="/images/trans-logo.png" type="image/x-icon" />

  <link href="atom.xml" rel="alternate" title="blog.webrite.rubyforge.org" type="application/atom+xml" />

  <!-- STYLESHEETS -->

  <link href="/styles/reset.css"  rel="stylesheet" type="text/css" />
  <link href="/styles/screen.css" rel="stylesheet" type="text/css" media="screen, projection" />
  <link href="/styles/print.css"  rel="stylesheet" type="text/css" media="print" />

  <!--[if IE]>
      <link href="/ie.css" media="screen, projection" rel="stylesheet" type="text/css" />
  <![endif]-->

  <link href="/styles/tag.css"    rel="stylesheet" type="text/css" />
  <link href="/styles/class.css"  rel="stylesheet" type="text/css" />

  <link href="/styles/syntax.css"  rel="stylesheet" type="text/css" />

  <!-- <script src="js/rdocs.js" type="text/javascript"></script> -->
</head>
<body>

<div id="header">
  <div id="header-inner">
    <div class="title">
      <img class="logo" src="/images/transcode.png" width="480px" align="top" />
    </div>
    <div class="menu" style="text-align: left;">
      <div class="menu-inner">
        <a href="/index.html">Home</a> &middot;
        <a href="/tags.html">Tags</a> &middot;
        <a href="/puddy.html">Puddy</a> &middot;
        <a href="/about.html">About</a>
      </div>
    </div>
  </div>
</div>

<div class="doc">
  
<div class="page">

  <div class="article-title">
    A Case for Module Inheritance
    <span style="font-size: 0.5em;">
    <a href="http://trans.github.com/20100413-module-inheritence/index.html#disqus_thread">Comments</a>
    </span>
  </div>

  <p>I love beautifully written code. Unfortunately the realities of the
language sometimes clash with requirements of the implementation. While
Ruby goes a long way toward making beautifully written code common place.
It still has some shortcomings I'd like to see improved.</p>

<p>Case in point are my endeavors of the last few days. I've been struggling
to re-structure the code of the <a href="http://github.com/rubyworks/english/">English</a>
project. The primary purpose of the project is to provide extension methods to String,
pertaining to the English language. A good example are number inflection
methods #singular and #plural. At the same time I am trying to design
the library in such a way that other language modules can be built following
the same basic structure, and they could all work together if need be.</p>

<p>In the course of this endeavor I decided the best approach, keeping the future
squarely in mind, is to create a Language module, upon which English depends,
to house all the common logic of (most) languages. For example, the logic for
storing plural and singular special cases might be a good candidate since nearly
every language has to account for these. So the relationship between English
and Language is clearly one of "inheritance" --I want to encapsulate logic at
a general level of abstraction, upon which more specific cases can inherit and
augment to fit their particular requirements.</p>

<p>In Ruby this kind of relationship is generally handled by class inheritance.
But here I run into an issue. <code>English</code> and <code>Language</code>
are modules, and they are modules because they are <i>singleton</i>. Now even
though we can include a module into another, which is akin to class inheritance,
it does not work quite like class inheritance. For one thing, metaclass methods
are not inherited via <code>include</code>. Of course, I could tip-toe around
this issue by using <code>extend</code>, since in this case I do not need
includable instance methods. But there is a much more subtle issues that
raises it's head: the dreaded Double Inclusion Problem. That's a serious
headache in my case because I want my end users to have the option to load
only the components they want to use as needed, rather than forcing them to
load the entire system up-front.</p>

<p>So, despite the many
<a href="http://www.google.com/search?q=singleton+pattern+evil">calls for the death
of the Singleton Pattern</a>, it looks like I might require it for my implementation
of English. Using modules simply comes with too many headaches and hackish work arounds.
Now I agree with all the Singleton nay-sayers. It is sort of an anti-pattern to
create a class that will only ever have one instantiation and no state, but
the trade-off here is worse. If only...</p>

<p>It seems to me the truly fantastic solution to this would be if one module
could inherit from another just as we do with classes. And honestly, is there
really any reason we shouldn't be able to do this?</p>

<div class="CodeRay">
  <div class="code"><pre>
  <span style="color:#080;font-weight:bold">module</span> <span style="color:#B06;font-weight:bold">Language</span>

    <span style="color:#080;font-weight:bold">def</span> <span style="color:#038;font-weight:bold">self</span>.<span style="color:#06B;font-weight:bold">words</span>(string)
      <span style="color:#888"># generic definition</span>
    <span style="color:#080;font-weight:bold">end</span>

  <span style="color:#080;font-weight:bold">end</span>

  <span style="color:#080;font-weight:bold">module</span> <span style="color:#B06;font-weight:bold">English</span> &lt; <span style="color:#036;font-weight:bold">Language</span>

    <span style="color:#080;font-weight:bold">def</span> <span style="color:#038;font-weight:bold">self</span>.<span style="color:#06B;font-weight:bold">words</span>(string)
      <span style="color:#888"># override</span>
    <span style="color:#080;font-weight:bold">end</span>

  <span style="color:#080;font-weight:bold">end</span>

</pre></div>
</div>

<p>What is nice about this, something I know that Matz will appreciate, is that
it preserves single-inheritance, in contrast to the alternative of
turning <code>include</code> into a multiple-inheritance mechanism. And
for the love of code beauty, it would mean at least a reduction in use of the
all too common:</p>

<div class="CodeRay">
  <div class="code"><pre>
  <span style="color:#080;font-weight:bold">def</span> <span style="color:#038;font-weight:bold">self</span>.<span style="color:#06B;font-weight:bold">included</span>(base)
    base.extend <span style="color:#036;font-weight:bold">ClassMethods</span>
  <span style="color:#080;font-weight:bold">end</span>

  <span style="color:#080;font-weight:bold">module</span> <span style="color:#B06;font-weight:bold">ClassMethods</span>
    <span style="color:#888"># ...</span>
  <span style="color:#080;font-weight:bold">end</span>

</pre></div>
</div>

<p>Not only is it ugly, it is even worse for those trying to inherit and
extend the behavior. Something more elegant is clearly desirable, and
Module Inheritance, as I have demonstrated here, might be just the ticket.</p>


  <small>Written by trans, 2010-04-13</small>

  <ul class="posts">
    
    
  </ul>

  <br/><br/>

  <!-- Commment vis Disqus -->
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    /**
      * var disqus_identifier; [Optional but recommended: Define a unique identifier (e.g. post id or slug) for this thread] 
      */
    (function() {
     var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
     dsq.src = 'http://transcode.disqus.com/embed.js';
     (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=transcode">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

</div>


</div>

<br style="clear: both;"/><br/><br/>

<div class="footer">
<div class="footer-inner">
  Copyright (c) 2005,2009 Thomas Sawyer
</div>
</div>

<!-- Disqus Comment Counter -->
<script type="text/javascript">
//<![CDATA[
(function() {
	var links = document.getElementsByTagName('a');
	var query = '?';
	for(var i = 0; i < links.length; i++) {
	if(links[i].href.indexOf('#disqus_thread') >= 0) {
		query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
	}
	}
	document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/transcode/get_num_replies.js' + query + '"></' + 'script>');
})();
//]]>
</script>

<!-- Google Analytics -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-2883355-2";
urchinTracker();
</script>

</body>
</html>

